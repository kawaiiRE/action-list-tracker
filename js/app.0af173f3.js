(()=>{"use strict";var e={801:(e,t,s)=>{var r=s(751),a=s(641);function l(e,t,s,r,l,o){const i=(0,a.g2)("HomePage"),n=(0,a.g2)("va-app");return(0,a.uX)(),(0,a.Wv)(n,null,{default:(0,a.k6)(()=>[(0,a.bF)(i)]),_:1})}var o=s(33);const i="data:image/webp;base64,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",n={key:0,class:"loading-container"},d={class:"loading-content"},u={key:2,class:"body"},c={class:"navbar-right"},m={key:0,class:"home-page"},h={class:"action-boxes"},p={class:"action-title"},f={class:"action-description"},g={key:1},b={class:"requests-header"},w={class:"filters-container"},v={class:"filters-section"},k={class:"main-filters"},y={class:"advanced-filters"},q={key:2};function D(e,t,s,r,l,D){const C=(0,a.g2)("va-icon"),E=(0,a.g2)("LoginView"),V=(0,a.g2)("va-navbar-item"),F=(0,a.g2)("UserAvatar"),_=(0,a.g2)("va-navbar"),A=(0,a.g2)("va-button"),L=(0,a.g2)("va-chip"),U=(0,a.g2)("va-card-content"),R=(0,a.g2)("va-card"),S=(0,a.g2)("VaIcon"),x=(0,a.g2)("va-input"),P=(0,a.g2)("va-select"),N=(0,a.g2)("va-date-input"),I=(0,a.g2)("va-collapse"),M=(0,a.g2)("RequestList"),T=(0,a.g2)("RequestForm"),O=(0,a.g2)("RequestDetailsModal"),W=(0,a.g2)("ExportModal"),B=(0,a.g2)("EditRequestModal"),z=(0,a.g2)("va-container"),X=(0,a.g2)("UserProfileModal"),Q=(0,a.g2)("UserManagementModal");return e.authLoading?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",d,[(0,a.bF)(C,{name:"autorenew",spin:"",size:"large",color:"primary"}),t[12]||(t[12]=(0,a.Lk)("p",{class:"loading-text"},"Loading...",-1))])])):e.isAuthenticated?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.bF)(_,{color:"primary",class:"main-navbar"},{left:(0,a.k6)(()=>[(0,a.bF)(V,null,{default:(0,a.k6)(()=>t[13]||(t[13]=[(0,a.Lk)("img",{src:i,alt:"Logo",class:"logo"},null,-1),(0,a.Lk)("h2",null,"AZAD Properties : BAS - Project Integration",-1)])),_:1,__:[13]})]),right:(0,a.k6)(()=>[(0,a.Lk)("div",c,[(0,a.bF)(F,{"user-profile":e.currentUserProfile,onEditProfile:e.openProfileModal,onLogout:e.handleLogout},null,8,["user-profile","onEditProfile","onLogout"])])]),_:1}),(0,a.bF)(z,{class:"main-content"},{default:(0,a.k6)(()=>["home"===e.currentView?((0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("div",h,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Object.entries(e.availableActions).filter(([e,t])=>t.enabled),([s,r])=>((0,a.uX)(),(0,a.Wv)(R,{key:s,onClick:t=>e.selectAction(s),class:(0,o.C4)(["action-box",{disabled:!r.enabled}]),hover:""},{default:(0,a.k6)(()=>[(0,a.bF)(U,{class:"action-box-content"},{default:(0,a.k6)(()=>[(0,a.bF)(C,{name:r.icon,size:"3rem",color:r.enabled?r.color:"secondary",class:"action-icon"},null,8,["name","color"]),(0,a.Lk)("h4",p,(0,o.v_)(r.title),1),(0,a.Lk)("p",f,(0,o.v_)(r.description),1),r.enabled?((0,a.uX)(),(0,a.Wv)(A,{key:0,color:r.color,size:"small",class:"action-button"},{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)(r.buttonText),1)]),_:2},1032,["color"])):((0,a.uX)(),(0,a.Wv)(L,{key:1,color:"secondary",size:"small",class:"no-access-chip"},{default:(0,a.k6)(()=>t[14]||(t[14]=[(0,a.eW)(" No Access ")])),_:1,__:[14]}))]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))])])):(0,a.Q3)("",!0),"requests"===e.currentView?((0,a.uX)(),(0,a.CE)("div",g,[(0,a.Lk)("div",b,[(0,a.bF)(A,{onClick:e.goHome,icon:"arrow_back",preset:"plain",class:"back-button","border-color":"primary"},{default:(0,a.k6)(()=>t[15]||(t[15]=[(0,a.eW)(" Back ")])),_:1,__:[15]},8,["onClick"]),(0,a.bF)(A,{onClick:e.openExportModal,icon:"download",color:"primary",preset:"secondary","border-color":"primary",class:"export-button"},{default:(0,a.k6)(()=>t[16]||(t[16]=[(0,a.eW)(" Export Excel ")])),_:1,__:[16]},8,["onClick"])]),t[17]||(t[17]=(0,a.Lk)("h3",{class:"requests-title"},"Action Requests",-1)),(0,a.Lk)("div",w,[(0,a.bF)(x,{modelValue:e.filters.search,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filters.search=t),label:"Search Requests",placeholder:"Search by title, details, sender, or department...","prepend-icon":"search",clearable:"",class:"search-input"},{appendInner:(0,a.k6)(()=>[(0,a.bF)(S,{name:"search",color:"secondary"})]),_:1},8,["modelValue"]),(0,a.Lk)("div",v,[(0,a.Lk)("div",k,[(0,a.bF)(P,{modelValue:e.filters.status,"onUpdate:modelValue":t[1]||(t[1]=t=>e.filters.status=t),options:["All","Open","In-Progress","Closed"],label:"Status",class:"filter-select"},null,8,["modelValue"]),(0,a.bF)(P,{modelValue:e.filters.senderDepartment,"onUpdate:modelValue":t[2]||(t[2]=t=>e.filters.senderDepartment=t),options:e.senderDepartmentOptions,label:"Sent From",class:"filter-select"},null,8,["modelValue","options"]),(0,a.bF)(P,{modelValue:e.filters.receiverDepartment,"onUpdate:modelValue":t[3]||(t[3]=t=>e.filters.receiverDepartment=t),options:e.receiverDepartmentOptions,label:"Sent To",class:"filter-select"},null,8,["modelValue","options"])]),(0,a.bF)(I,{modelValue:e.showAdvancedFilters,"onUpdate:modelValue":t[6]||(t[6]=t=>e.showAdvancedFilters=t)},{header:(0,a.k6)(()=>[(0,a.bF)(A,{preset:"plain",icon:"tune",size:"small"},{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)(e.showAdvancedFilters?"Hide":"Show")+" Advanced Filters ",1)]),_:1})]),default:(0,a.k6)(()=>[(0,a.Lk)("div",y,[(0,a.bF)(N,{modelValue:e.filters.dateFrom,"onUpdate:modelValue":t[4]||(t[4]=t=>e.filters.dateFrom=t),label:"From Date",class:"filter-select",clearable:""},null,8,["modelValue"]),(0,a.bF)(N,{modelValue:e.filters.dateTo,"onUpdate:modelValue":t[5]||(t[5]=t=>e.filters.dateTo=t),label:"To Date",class:"filter-select",clearable:""},null,8,["modelValue"])])]),_:1},8,["modelValue"])])]),(0,a.bF)(M,{requests:e.filteredRequests,"can-comment":e.canComment,"can-delete":e.canDelete,"can-delete-all":e.canDeleteAll,"is-view-only":e.isViewOnly,"current-user-id":e.currentUserProfile?.uid,onComment:e.handleComment,onViewRequest:e.showRequestDetails,onDeleteRequest:e.confirmDeleteRequestFromList},null,8,["requests","can-comment","can-delete","can-delete-all","is-view-only","current-user-id","onComment","onViewRequest","onDeleteRequest"])])):(0,a.Q3)("",!0),"add-request"===e.currentView?((0,a.uX)(),(0,a.CE)("div",q,[(0,a.bF)(A,{onClick:e.goHome,icon:"arrow_back",preset:"plain",class:"back-button","border-color":"primary"},{default:(0,a.k6)(()=>t[18]||(t[18]=[(0,a.eW)(" Back ")])),_:1,__:[18]},8,["onClick"]),t[19]||(t[19]=(0,a.Lk)("h3",{class:"add-request-title"},"Add New Request",-1)),(0,a.bF)(T,{onSubmit:e.handleNewRequest},null,8,["onSubmit"])])):(0,a.Q3)("",!0),(0,a.bF)(O,{modelValue:e.showRequestDetailsModal,"onUpdate:modelValue":t[7]||(t[7]=t=>e.showRequestDetailsModal=t),request:e.selectedRequest,comments:e.selectedRequestComments,"is-view-only":e.isViewOnly,"can-comment":e.canComment,"can-delete":e.canDelete,"can-delete-all":e.canDeleteAll,"current-user-id":e.currentUserProfile?.uid,onCommentAdded:e.handleCommentAdded,onCommentDeleted:e.handleCommentDeleted,onRequestUpdated:e.handleRequestUpdated,onRequestDeleted:e.handleRequestDeleted,onEditRequest:e.handleEditRequest,onReloadData:e.loadRequests},null,8,["modelValue","request","comments","is-view-only","can-comment","can-delete","can-delete-all","current-user-id","onCommentAdded","onCommentDeleted","onRequestUpdated","onRequestDeleted","onEditRequest","onReloadData"]),(0,a.bF)(W,{modelValue:e.showExportModal,"onUpdate:modelValue":t[8]||(t[8]=t=>e.showExportModal=t),requests:e.requests,"current-filters":e.filters},null,8,["modelValue","requests","current-filters"]),(0,a.bF)(B,{modelValue:e.showEditRequestModal,"onUpdate:modelValue":t[9]||(t[9]=t=>e.showEditRequestModal=t),request:e.selectedRequest,onRequestUpdated:e.handleRequestUpdated,onReloadData:e.loadRequests},null,8,["modelValue","request","onRequestUpdated","onReloadData"])]),_:1}),(0,a.bF)(X,{"is-visible":e.showProfileModal,"user-profile":e.currentUserProfile,onSaved:e.handleProfileSave,onClose:t[10]||(t[10]=t=>e.showProfileModal=!1)},null,8,["is-visible","user-profile","onSaved"]),(0,a.bF)(Q,{modelValue:e.showUserManagementModal,"onUpdate:modelValue":t[11]||(t[11]=t=>e.showUserManagementModal=t)},null,8,["modelValue"])])):((0,a.uX)(),(0,a.Wv)(E,{key:1,onLoginSuccess:e.handleLoginSuccess,"session-expired":e.sessionExpired},null,8,["onLoginSuccess","session-expired"]))}const C={class:"requests-grid"};function E(e,t,s,r,l,o){const i=(0,a.g2)("request-card");return(0,a.uX)(),(0,a.CE)("div",C,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.requests,t=>((0,a.uX)(),(0,a.Wv)(i,{key:t.id,request:t,"can-comment":e.canComment,"can-delete":e.canDelete,"can-delete-all":e.canDeleteAll,"is-view-only":e.isViewOnly,"current-user-id":e.currentUserId,onComment:e.emitComment,onViewRequest:e.viewRequest,onDeleteRequest:e.deleteRequest},null,8,["request","can-comment","can-delete","can-delete-all","is-view-only","current-user-id","onComment","onViewRequest","onDeleteRequest"]))),128))])}const V={class:"card-header"},F={class:"title-section"},_={class:"request-id"},A={class:"request-title"},L={class:"request-meta"},U={class:"meta-item"},R={class:"meta-item"},S={class:"meta-item"},x={class:"meta-item"},P={class:"request-details"},N={key:0};function I(e,t,s,l,i,n){const d=(0,a.g2)("va-badge"),u=(0,a.g2)("va-icon"),c=(0,a.g2)("va-button"),m=(0,a.g2)("va-card-content"),h=(0,a.g2)("va-card");return(0,a.uX)(),(0,a.Wv)(h,{class:"request-card clickable-card",onClick:e.handleCardClick},{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",V,[(0,a.Lk)("div",F,[(0,a.Lk)("div",_,"#"+(0,o.v_)(e.request.requestNumber),1),(0,a.Lk)("h3",A,(0,o.v_)(e.request.title),1)]),(0,a.bF)(d,{text:e.request.status,color:e.statusColor,class:"status-badge"},null,8,["text","color"])]),(0,a.Lk)("div",L,[(0,a.Lk)("div",U,[(0,a.bF)(u,{name:"person",size:"small"}),(0,a.Lk)("span",null,[t[1]||(t[1]=(0,a.Lk)("strong",null,"Sender:",-1)),(0,a.eW)(" "+(0,o.v_)(e.request.senderName),1)])]),(0,a.Lk)("div",R,[(0,a.bF)(u,{name:"business",size:"small"}),(0,a.Lk)("span",null,[t[2]||(t[2]=(0,a.Lk)("strong",null,"From:",-1)),(0,a.eW)(" "+(0,o.v_)(e.request.senderDepartment),1)])]),(0,a.Lk)("div",S,[(0,a.bF)(u,{name:"business",size:"small"}),(0,a.Lk)("span",null,[t[3]||(t[3]=(0,a.Lk)("strong",null,"To:",-1)),(0,a.eW)(" "+(0,o.v_)(e.request.receiverDepartment),1)])]),(0,a.Lk)("div",x,[(0,a.bF)(u,{name:"schedule",size:"small"}),(0,a.Lk)("span",null,[t[4]||(t[4]=(0,a.Lk)("strong",null,"Created:",-1)),(0,a.eW)(" "+(0,o.v_)(e.formattedDate),1)])])]),(0,a.Lk)("div",P,[(0,a.Lk)("p",null,(0,o.v_)(e.request.details),1)]),(0,a.Lk)("div",{class:"card-actions",onClick:t[0]||(t[0]=(0,r.D$)(()=>{},["stop"]))},[(0,a.bF)(c,{onClick:e.viewDetails,color:"primary",size:"small",icon:"visibility"},{default:(0,a.k6)(()=>t[5]||(t[5]=[(0,a.eW)(" View Details ")])),_:1,__:[5]},8,["onClick"]),e.canDeleteThis?((0,a.uX)(),(0,a.Wv)(c,{key:0,onClick:e.deleteRequest,color:"danger",size:"small",icon:"delete",outline:""},{default:(0,a.k6)(()=>t[6]||(t[6]=[(0,a.eW)(" Delete ")])),_:1,__:[6]},8,["onClick"])):(0,a.Q3)("",!0)]),e.comments.length>0?((0,a.uX)(),(0,a.CE)("span",N,"Comments: ("+(0,o.v_)(e.comments.length)+")",1)):(0,a.Q3)("",!0)]),_:1})]),_:1},8,["onClick"])}const M={class:"add-comment"},T={class:"comment-form"},O={class:"form-actions"},W={class:"char-count"};function B(e,t,s,r,l,i){const n=(0,a.g2)("va-textarea"),d=(0,a.g2)("va-button");return(0,a.uX)(),(0,a.CE)("div",M,[(0,a.Lk)("div",T,[(0,a.bF)(n,{modelValue:e.text,"onUpdate:modelValue":t[0]||(t[0]=t=>e.text=t),placeholder:"Add a comment... (Ctrl+Enter to submit)",rows:3,disabled:e.isSubmittingComment,onKeydown:e.handleKeydown,class:"comment-textarea"},null,8,["modelValue","disabled","onKeydown"]),(0,a.Lk)("div",O,[(0,a.Lk)("div",W,(0,o.v_)(e.text.length)+"/500",1),(0,a.bF)(d,{onClick:e.submit,disabled:!e.isValid||e.isSubmittingComment,loading:e.isSubmittingComment,color:"primary",size:"small"},{default:(0,a.k6)(()=>t[1]||(t[1]=[(0,a.eW)(" Submit Comment ")])),_:1,__:[1]},8,["onClick","disabled","loading"])])])])}const z=(0,a.pM)({name:"AddComment",props:{isSubmittingComment:{type:Boolean,default:!1}},data(){return{text:""}},computed:{isValid(){return this.text.trim().length>0}},methods:{async submit(){if(this.isValid&&!this.isSubmittingComment)try{this.$emit("submit",this.text.trim()),this.text=""}catch(e){console.error("Error submitting comment:",e)}},handleKeydown(e){"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.submit())}}});var X=s(262);const Q=(0,X.A)(z,[["render",B]]),H=Q;var G=s(223),Z=s(884),J=s(415);const $={apiKey:"AIzaSyAraOkRAPZ6RZTgeaX3QcMFRNe9qM2FsEQ",authDomain:"aazad-properties.firebaseapp.com",projectId:"aazad-properties",storageBucket:"aazad-properties.appspot.com",messagingSenderId:"275411023313",appId:"1:275411023313:web:9cfaaa62b577fc1ccfdcf0",measurementId:"G-Y1G9PLEG3N"},j=["VUE_APP_FIREBASE_API_KEY","VUE_APP_FIREBASE_AUTH_DOMAIN","VUE_APP_FIREBASE_PROJECT_ID","VUE_APP_FIREBASE_STORAGE_BUCKET","VUE_APP_FIREBASE_MESSAGING_SENDER_ID","VUE_APP_FIREBASE_APP_ID"],K=j.filter(e=>!{NODE_ENV:"production",VUE_APP_DEFAULT_ADMIN_EMAIL:"admin@admin.com",VUE_APP_DEFAULT_ADMIN_PASSWORD:"admin1234",VUE_APP_FIREBASE_API_KEY:"AIzaSyAraOkRAPZ6RZTgeaX3QcMFRNe9qM2FsEQ",VUE_APP_FIREBASE_APP_ID:"1:275411023313:web:9cfaaa62b577fc1ccfdcf0",VUE_APP_FIREBASE_AUTH_DOMAIN:"aazad-properties.firebaseapp.com",VUE_APP_FIREBASE_MEASUREMENT_ID:"G-Y1G9PLEG3N",VUE_APP_FIREBASE_MESSAGING_SENDER_ID:"275411023313",VUE_APP_FIREBASE_PROJECT_ID:"aazad-properties",VUE_APP_FIREBASE_STORAGE_BUCKET:"aazad-properties.appspot.com",VUE_APP_SESSION_DURATION_DAYS:"7",VUE_APP_SUPERADMIN_EMAIL:"elhadyrachida71@gmail.com",BASE_URL:"/action-list-tracker/"}[e]);if(K.length>0)throw new Error(`Missing required environment variables: ${K.join(", ")}. Please check your .env file and ensure all Firebase configuration variables are set.`);const Y=(0,G.Wp)($),ee=(0,Z.aU)(Y),te=(0,J.xI)(Y),se=(0,G.Wp)($,"admin"),re=(0,J.xI)(se);async function ae(e,t){try{const s=await(0,J.x9)(te,e,t);return s.user}catch(s){throw console.error("Error signing in:",s),s}}async function le(){try{await(0,J.CI)(te)}catch(e){throw console.error("Error signing out:",e),e}}function oe(e){return(0,J.hg)(te,e)}function ie(){return te.currentUser}const ne="elhadyrachida71@gmail.com";function de(e){return ne?e===ne:(console.warn("VUE_APP_SUPERADMIN_EMAIL environment variable is not set"),!1)}function ue(e,t,s){if(de(s))return!0;const r={viewer:["view"],user:["view","create","comment","edit_own","delete_own"],admin:["view","create","comment","edit_own","delete_own","edit_all","delete_all","manage_users"]};return r[e]?.includes(t)||!1}function ce(e,t){return!de(t)&&"viewer"===e}function me(e,t){return!!de(t)||"admin"===e}async function he(){const e=ie();if(!e)throw new Error("User must be authenticated to access users");const t=await be(e.uid);if(!t||!me(t.role,t.email))throw new Error("Insufficient permissions to access users");try{const e=(0,Z.rJ)(ee,"users"),t=await(0,Z.GG)(e);return t.docs.map(e=>({uid:e.id,...e.data()}))}catch(s){throw console.error("Error fetching users:",s),s}}async function pe(e,t,s){const r=ie();if(!r)throw new Error("User must be authenticated to create users");const a=await be(r.uid);if(!a||!me(a.role,a.email))throw new Error("Insufficient permissions to create users");try{const r=await(0,J.eJ)(re,e,t),a=r.user;return await we({uid:a.uid,email:a.email||e,...s}),await re.signOut(),{success:!0,uid:a.uid}}catch(l){throw console.error("Error creating user:",l),l}}async function fe(e,t){const s=ie();if(!s)throw new Error("User must be authenticated to update user roles");const r=await be(s.uid);if(!r||!me(r.role,r.email))throw new Error("Insufficient permissions to update user roles");try{await ve(e,{role:t})}catch(a){throw console.error("Error updating user role:",a),a}}async function ge(e){const t=ie();if(!t)throw new Error("User must be authenticated to delete users");const s=await be(t.uid);if(!s||!me(s.role,s.email))throw new Error("Insufficient permissions to delete users");try{const t=(0,Z.H9)(ee,"users",e);await(0,Z.kd)(t)}catch(r){throw console.error("Error deleting user:",r),r}}async function be(e){try{const t=(0,Z.H9)(ee,"users",e),s=await(0,Z.x7)(t);return s.exists()?{uid:e,...s.data()}:null}catch(t){throw console.error("Error getting user profile:",t),t}}async function we(e){try{const t=(0,Z.H9)(ee,"users",e.uid);await(0,Z.BN)(t,{...e,role:e.role||"user",createdAt:Date.now(),updatedAt:Date.now()})}catch(t){throw console.error("Error creating user profile:",t),t}}async function ve(e,t){try{const s=(0,Z.H9)(ee,"users",e);await(0,Z.mZ)(s,{...t,updatedAt:Date.now()})}catch(s){throw console.error("Error updating user profile:",s),s}}const ke=(0,Z.rJ)(ee,"requests");async function ye(e){const t=ie();if(!t)throw new Error("User must be authenticated to access requests");try{let t=(0,Z.P)(ke,(0,Z.My)("createdAt","desc"));const s=await(0,Z.GG)(t);let r=s.docs.map(e=>({id:e.id,...e.data()}));if(e&&(e.status&&(r=r.filter(t=>t.status===e.status)),e.department&&(r=r.filter(t=>t.receiverDepartment===e.department)),e.search)){const t=e.search.toLowerCase();r=r.filter(e=>e.title.toLowerCase().includes(t)||e.details.toLowerCase().includes(t))}return r}catch(s){throw console.error("Error fetching requests:",s),s}}async function qe(e){const t=ie();if(!t)throw new Error("User must be authenticated to create requests");const s=await be(t.uid);if(!s)throw new Error("User profile not found");if(!ue(s.role,"create",s.email))throw new Error("Insufficient permissions to create requests");const r=await(0,Z.c4)(ee,async r=>{const a=(0,Z.H9)(ee,"metadata","requestCounter"),l=await r.get(a);let o=1;l.exists()&&(o=l.data().nextNumber||1),r.set(a,{nextNumber:o+1});const i={...e,requestNumber:o,senderId:t.uid,senderName:`${s.firstName} ${s.lastName}`,senderDepartment:s.department,createdAt:Date.now()},n=(0,Z.H9)(ke);return r.set(n,i),n.id});return r}async function De(e){const t=(0,Z.rJ)((0,Z.H9)(ee,"requests",e),"comments"),s=await(0,Z.GG)(t),r=s.docs.map(e=>({id:e.id,...e.data()}));return r.sort((e,t)=>e.createdAt-t.createdAt)}async function Ce(e){try{const t=(0,Z.H9)(ee,"requests",e),s=await(0,Z.x7)(t);if(!s.exists())return null;const r={id:s.id,...s.data()},a=await De(e);return r.comments=a,r}catch(t){throw console.error("Error fetching request by ID:",t),t}}async function Ee(e){const t=ie();if(!t)throw new Error("User must be authenticated to delete requests");const s=await be(t.uid);if(!s)throw new Error("User profile not found");if(!ue(s.role,"delete_all",s.email)){const r=await Ce(e);if(!r||r.senderId!==t.uid)throw new Error("Insufficient permissions to delete this request");if(!ue(s.role,"delete_own",s.email))throw new Error("Insufficient permissions to delete requests")}try{const t=(0,Z.H9)(ee,"requests",e);await(0,Z.kd)(t)}catch(r){throw console.error("Error deleting request:",r),r}}async function Ve(e,t){try{const s=(0,Z.H9)(ee,"requests",e);await(0,Z.mZ)(s,{...t,updatedAt:Date.now()})}catch(s){throw console.error("Error updating request:",s),s}}async function Fe(e,t){const s=ie();if(!s)throw new Error("User must be authenticated to add comments");const r=await be(s.uid);if(!r)throw new Error("User profile not found");if(!ue(r.role,"comment",r.email))throw new Error("Insufficient permissions to add comments");const a=(0,Z.rJ)((0,Z.H9)(ee,"requests",e),"comments"),l=await(0,Z.gS)(a,{text:t,authorId:s.uid,authorName:`${r.firstName} ${r.lastName}`,createdAt:Date.now()});return l.id}async function _e(e,t){const s=ie();if(!s)throw new Error("User must be authenticated to delete comments");const r=await be(s.uid);if(!r)throw new Error("User profile not found");if(!ue(r.role,"delete_all",r.email)){const a=(0,Z.H9)(ee,"requests",e,"comments",t),l=await(0,Z.x7)(a);if(!l.exists())throw new Error("Comment not found");const o=l.data();if(o.authorId!==s.uid)throw new Error("Insufficient permissions to delete this comment");if(!ue(r.role,"delete_own",r.email))throw new Error("Insufficient permissions to delete comments")}try{const s=(0,Z.H9)(ee,"requests",e,"comments",t);await(0,Z.kd)(s)}catch(a){throw console.error("Error deleting comment:",a),a}}async function Ae(e,t){const s=ie();if(!s)throw new Error("User must be authenticated to add system comments");const r=await be(s.uid);if(!r)throw new Error("User profile not found");const a=(0,Z.rJ)((0,Z.H9)(ee,"requests",e),"comments"),l=await(0,Z.gS)(a,{text:t,authorId:"system",authorName:`System (${r.firstName} ${r.lastName})`,createdAt:Date.now(),isSystemComment:!0});return l.id}async function Le(e,t,s){const r=ie();if(!r)throw new Error("User must be authenticated to update comments");const a=await be(r.uid);if(!a)throw new Error("User profile not found");const l=(0,Z.H9)(ee,"requests",e,"comments",t),o=await(0,Z.x7)(l);if(!o.exists())throw new Error("Comment not found");const i=o.data();if(i.authorId!==r.uid)throw new Error("You can only edit your own comments");if(!ue(a.role,"comment",a.email))throw new Error("Insufficient permissions to update comments");try{await(0,Z.mZ)(l,{text:s,updatedAt:Date.now(),isEdited:!0})}catch(n){throw console.error("Error updating comment:",n),n}}function Ue(e){switch(e){case"Open":return"primary";case"In-Progress":return"warning";case"Closed":return"success";default:return"secondary"}}const Re=(0,a.pM)({name:"RequestCard",components:{AddComment:H},emits:["comment","view-request","delete-request"],props:{request:{type:Object,required:!0},canComment:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canDeleteAll:{type:Boolean,default:!1},isViewOnly:{type:Boolean,default:!1},currentUserId:{type:String,default:""}},data(){return{comments:[],showComments:!1,loadingComments:!1}},computed:{statusColor(){return Ue(this.request.status)},formattedDate(){return new Date(this.request.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},canDeleteThis(){return this.canDeleteAll||this.canDelete&&this.request.senderId===this.currentUserId},canCommentThis(){return this.canComment&&!this.isViewOnly}},methods:{handleCardClick(){this.viewDetails()},viewDetails(){this.$emit("view-request",this.request)},deleteRequest(){this.$emit("delete-request",this.request)},async onComment(e){this.request.id&&(this.$emit("comment",{id:this.request.id,text:e}),this.showComments&&await this.loadComments())},async toggleComments(){this.showComments=!this.showComments,this.showComments&&0===this.comments.length&&await this.loadComments()},async loadComments(){if(this.request.id){this.loadingComments=!0;try{this.comments=await De(this.request.id)}catch(e){console.error("Error loading comments:",e)}finally{this.loadingComments=!1}}}}}),Se=(0,X.A)(Re,[["render",I]]),xe=Se,Pe=(0,a.pM)({name:"RequestList",components:{RequestCard:xe},props:{requests:{type:Array,required:!0},canComment:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canDeleteAll:{type:Boolean,default:!1},isViewOnly:{type:Boolean,default:!1},currentUserId:{type:String,default:""}},emits:["comment","view-request","delete-request"],methods:{emitComment(e){this.$emit("comment",e)},viewRequest(e){this.$emit("view-request",e)},deleteRequest(e){this.$emit("delete-request",e)}}}),Ne=(0,X.A)(Pe,[["render",E]]),Ie=Ne,Me={class:"preview-item"},Te={class:"preview-item"},Oe={class:"form-actions"};function We(e,t,s,l,i,n){const d=(0,a.g2)("va-card-title"),u=(0,a.g2)("va-card-content"),c=(0,a.g2)("va-card"),m=(0,a.g2)("va-input"),h=(0,a.g2)("va-select"),p=(0,a.g2)("va-textarea"),f=(0,a.g2)("va-button");return(0,a.uX)(),(0,a.Wv)(c,{class:"request-form-card"},{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>t[5]||(t[5]=[(0,a.eW)("Create New Request")])),_:1,__:[5]}),(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.bF)(c,{class:"sender-preview-card",color:"info",stripe:""},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[t[8]||(t[8]=(0,a.Lk)("h4",{class:"preview-title"},"Request Preview",-1)),(0,a.Lk)("p",Me,[t[6]||(t[6]=(0,a.Lk)("strong",null,"Sender:",-1)),(0,a.eW)(" "+(0,o.v_)(e.currentUserProfile?.firstName)+" "+(0,o.v_)(e.currentUserProfile?.lastName),1)]),(0,a.Lk)("p",Te,[t[7]||(t[7]=(0,a.Lk)("strong",null,"From Department:",-1)),(0,a.eW)(" "+(0,o.v_)(e.currentUserProfile?.department),1)])]),_:1,__:[8]})]),_:1}),(0,a.Lk)("form",{onSubmit:t[4]||(t[4]=(0,r.D$)((...t)=>e.onSubmit&&e.onSubmit(...t),["prevent"])),class:"request-form"},[(0,a.bF)(m,{modelValue:e.form.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.title=t),label:"Request Title",placeholder:"Enter a descriptive title for your request",rules:[e=>!!e||"Title is required"],required:"",class:"form-input"},null,8,["modelValue","rules"]),(0,a.bF)(h,{modelValue:e.form.receiverDepartment,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.receiverDepartment=t),label:"Request To Department",options:e.departments,placeholder:"Select which department should handle this request",rules:[e=>!!e||"Receiver department is required"],required:"",class:"form-input"},null,8,["modelValue","options","rules"]),(0,a.bF)(p,{modelValue:e.form.details,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.details=t),label:"Request Details",placeholder:"Provide detailed information about your request...",rows:4,class:"form-textarea"},null,8,["modelValue"]),(0,a.bF)(h,{modelValue:e.form.status,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.status=t),label:"Initial Status",options:e.statuses,rules:[e=>!!e||"Status is required"],required:"",class:"status-select"},null,8,["modelValue","options","rules"]),(0,a.Lk)("div",Oe,[(0,a.bF)(f,{type:"button",onClick:e.resetForm,outline:"",disabled:e.isSubmitting},{default:(0,a.k6)(()=>t[9]||(t[9]=[(0,a.eW)(" Reset Form ")])),_:1,__:[9]},8,["onClick","disabled"]),(0,a.bF)(f,{type:"submit",color:"primary",disabled:!e.isValid||e.isSubmitting,loading:e.isSubmitting},{default:(0,a.k6)(()=>t[10]||(t[10]=[(0,a.eW)(" Create Request ")])),_:1,__:[10]},8,["disabled","loading"])])],32)]),_:1})]),_:1})}const Be=["Asset Department","Projects Department","Business Development Department","Finance Department","Leasing Department","COO Office","Facilities Management Department","Accounting Department","IT Department","Property and Asset Management Department","HR Department","Accounts Department","Procurement Department","Contracts Department","Marketing Department","Strategic Department","Legal Department"],ze=["All",...Be],Xe=["All Sender Departments",...Be],Qe=["All Receiver Departments",...Be];var He=s(953);const Ge=(0,He.Kh)({isAuthenticated:!1,user:null,loading:!1,error:null,sessionExpired:!1}),Ze="action_tracker_user_session",Je=24*parseInt("7",10)*60*60*1e3;class $e{get canCreateRequests(){return!!Ge.user&&ue(Ge.user.role,"create",Ge.user.email)}get canComment(){return!!Ge.user&&ue(Ge.user.role,"comment",Ge.user.email)}get canDelete(){return!!Ge.user&&ue(Ge.user.role,"delete_own",Ge.user.email)}get canDeleteAll(){return!!Ge.user&&ue(Ge.user.role,"delete_all",Ge.user.email)}get canManageUsers(){return!!Ge.user&&me(Ge.user.role,Ge.user.email)}get isViewOnly(){return!!Ge.user&&ce(Ge.user.role,Ge.user.email)}get isSuperAdmin(){return!!Ge.user&&de(Ge.user.email)}get isAuthenticated(){return Ge.isAuthenticated}get user(){return Ge.user}get loading(){return Ge.loading}get error(){return Ge.error}get sessionExpired(){return Ge.sessionExpired}async initialize(){Ge.loading=!0,Ge.error=null;try{const e=this.getStoredSession();e&&this.isSessionValid(e)?Ge.loading=!0:this.clearStoredSession(),oe(async e=>{try{e?await this.handleAuthenticatedUser(e.uid,e.email||""):await this.handleUnauthenticatedUser()}catch(t){console.error("Error in auth state change:",t),Ge.error="Authentication error occurred"}finally{Ge.loading=!1}})}catch(e){console.error("Error initializing user store:",e),Ge.error="Failed to initialize authentication",Ge.loading=!1}}async handleAuthenticatedUser(e,t){try{const s=await be(e);s?(Ge.user=s,Ge.isAuthenticated=!0,Ge.sessionExpired=!1,this.storeUserSession({uid:e,email:t,lastLoginTime:Date.now(),rememberMe:!0})):(Ge.user=null,Ge.isAuthenticated=!0,Ge.sessionExpired=!1)}catch(s){console.error("Error loading user profile:",s),Ge.error="Failed to load user profile",await this.logout()}}async handleUnauthenticatedUser(){const e=this.getStoredSession();e&&this.isSessionValid(e)&&(Ge.sessionExpired=!0,Ge.error="Your session has expired. Please log in again."),Ge.user=null,Ge.isAuthenticated=!1,this.clearStoredSession()}async saveUserProfile(e){const t=ie();if(!t)throw new Error("User must be authenticated to save profile");Ge.loading=!0,Ge.error=null;try{if(Ge.user)await ve(t.uid,e);else{const s={uid:t.uid,email:t.email||"",firstName:e.firstName||"",lastName:e.lastName||"",department:e.department||"",title:e.title||"",role:e.role||"user"};await we(s)}const s=await be(t.uid);s&&(Ge.user=s)}catch(s){throw console.error("Error saving user profile:",s),Ge.error="Failed to save user profile",s}finally{Ge.loading=!1}}async logout(){try{await le()}catch(e){console.error("Error during logout:",e)}finally{Ge.user=null,Ge.isAuthenticated=!1,Ge.sessionExpired=!1,Ge.error=null,this.clearStoredSession()}}clearError(){Ge.error=null,Ge.sessionExpired=!1}hasPermission(e){return!!Ge.user&&ue(Ge.user.role,e,Ge.user.email)}hasRole(e){return!!Ge.user&&Ge.user.role===e}storeUserSession(e){try{localStorage.setItem(Ze,JSON.stringify(e))}catch(t){console.warn("Failed to store user session:",t)}}getStoredSession(){try{const e=localStorage.getItem(Ze);return e?JSON.parse(e):null}catch(e){return console.warn("Failed to get stored session:",e),null}}clearStoredSession(){try{localStorage.removeItem(Ze)}catch(e){console.warn("Failed to clear stored session:",e)}}isSessionValid(e){const t=Date.now(),s=t-e.lastLoginTime;return s<Je}}const je=new $e,Ke=(0,a.pM)({name:"RequestForm",data(){return{form:{title:"",details:"",status:"Open",receiverDepartment:""},statuses:["Open","In-Progress","Closed"],departments:Be,isSubmitting:!1}},computed:{currentUserProfile(){return je.user},isValid(){return this.form.title.trim()&&this.form.status&&this.form.receiverDepartment}},methods:{async onSubmit(){if(this.isValid&&!this.isSubmitting){this.isSubmitting=!0;try{this.$emit("submit",{...this.form})}finally{this.isSubmitting=!1}}},resetForm(){this.form={title:"",details:"",status:"Open",receiverDepartment:""}}}}),Ye=(0,X.A)(Ke,[["render",We]]),et=Ye,tt=s.p+"img/azad-logo.897b9799.svg",st={class:"login-container"},rt={class:"login-content"};function at(e,t,s,l,o,n){const d=(0,a.g2)("va-card-title"),u=(0,a.g2)("va-alert"),c=(0,a.g2)("va-input"),m=(0,a.g2)("va-button"),h=(0,a.g2)("va-card-content"),p=(0,a.g2)("va-card");return(0,a.uX)(),(0,a.CE)("div",st,[t[8]||(t[8]=(0,a.Lk)("div",{class:"logos-container"},[(0,a.Lk)("img",{src:tt,alt:"Right Logo",class:"logo logo-right"}),(0,a.Lk)("img",{src:i,alt:"Left Logo",class:"logo logo-left"})],-1)),(0,a.Lk)("div",rt,[t[7]||(t[7]=(0,a.Lk)("div",{class:"login-header"},[(0,a.Lk)("h1",null,"AZAD Properties : BAS - Project Integration")],-1)),(0,a.bF)(p,{class:"login-card"},{default:(0,a.k6)(()=>[(0,a.bF)(d,{class:"login-card-title"},{default:(0,a.k6)(()=>t[3]||(t[3]=[(0,a.Lk)("p",{class:"subtitle"},"Sign in to your account",-1)])),_:1,__:[3]}),(0,a.bF)(h,null,{default:(0,a.k6)(()=>[e.sessionExpired?((0,a.uX)(),(0,a.Wv)(u,{key:0,color:"warning",class:"session-expired-alert",border:"left","border-color":"warning"},{title:(0,a.k6)(()=>t[4]||(t[4]=[(0,a.eW)("Session Expired")])),default:(0,a.k6)(()=>[t[5]||(t[5]=(0,a.eW)(" Your session has expired. Please log in again to continue. "))]),_:1,__:[5]})):(0,a.Q3)("",!0),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)((...t)=>e.handleLogin&&e.handleLogin(...t),["prevent"]))},[(0,a.bF)(c,{modelValue:e.form.email,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.email=t),label:"Email",type:"email",rules:[e.required,e.email],class:"login-input",error:!!e.loginError},null,8,["modelValue","rules","error"]),(0,a.bF)(c,{modelValue:e.form.password,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.password=t),label:"Password",type:"password",rules:[e.required],class:"login-input",error:!!e.loginError,"error-messages":e.loginError?[e.loginError]:[]},null,8,["modelValue","rules","error","error-messages"]),(0,a.bF)(m,{type:"submit",color:"primary",block:"",loading:e.isLoggingIn,disabled:!e.isFormValid},{default:(0,a.k6)(()=>t[6]||(t[6]=[(0,a.eW)(" Sign In ")])),_:1,__:[6]},8,["loading","disabled"])],32)]),_:1})]),_:1})])])}const lt=(0,a.pM)({name:"LoginView",emits:["login-success"],props:{sessionExpired:{type:Boolean,default:!1}},data(){return{isLoggingIn:!1,loginError:"",form:{email:"",password:""}}},computed:{isFormValid(){return this.form.email.trim()&&this.form.password.trim()&&this.isValidEmail(this.form.email)}},methods:{required(e){return!!e?.trim()||"This field is required"},email(e){return!!this.isValidEmail(e)||"Please enter a valid email address"},isValidEmail(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)},async handleLogin(){if(this.isFormValid){this.isLoggingIn=!0,this.loginError="";try{await ae(this.form.email.trim(),this.form.password),this.$emit("login-success")}catch(e){console.error("Login failed:",e),"auth/user-not-found"===e.code||"auth/wrong-password"===e.code?this.loginError="Invalid email or password":"auth/invalid-email"===e.code?this.loginError="Invalid email address":"auth/too-many-requests"===e.code?this.loginError="Too many failed attempts. Please try again later":this.loginError="Login failed. Please try again"}finally{this.isLoggingIn=!1}}}}}),ot=(0,X.A)(lt,[["render",at]]),it=ot,nt={class:"user-avatar-container"},dt={class:"user-info"},ut={class:"user-name"},ct={class:"user-email"},mt={class:"user-details"},ht={class:"detail-item"},pt={class:"detail-item"},ft={class:"dropdown-actions"};function gt(e,t,s,r,l,i){const n=(0,a.g2)("va-avatar"),d=(0,a.g2)("va-button"),u=(0,a.g2)("va-card-content"),c=(0,a.g2)("va-card"),m=(0,a.g2)("va-dropdown");return(0,a.uX)(),(0,a.CE)("div",nt,[(0,a.bF)(n,{size:"medium",class:"user-avatar",color:"#ECF0F1",onClick:e.toggleDropdown},{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)(e.initials),1)]),_:1},8,["onClick"]),(0,a.bF)(m,{modelValue:e.showDropdown,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showDropdown=t),placement:"bottom-end","close-on-anchor-click":!1},{anchor:(0,a.k6)(()=>t[1]||(t[1]=[(0,a.Lk)("div",null,null,-1)])),default:(0,a.k6)(()=>[(0,a.bF)(c,{class:"user-dropdown"},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",dt,[(0,a.Lk)("div",ut,(0,o.v_)(e.fullName),1),(0,a.Lk)("div",ct,(0,o.v_)(e.userProfile?.email),1),(0,a.Lk)("div",mt,[(0,a.Lk)("div",ht,[t[2]||(t[2]=(0,a.Lk)("strong",null,"Department:",-1)),(0,a.eW)(" "+(0,o.v_)(e.userProfile?.department),1)]),(0,a.Lk)("div",pt,[t[3]||(t[3]=(0,a.Lk)("strong",null,"Title:",-1)),(0,a.eW)(" "+(0,o.v_)(e.userProfile?.title),1)])])]),(0,a.Lk)("div",ft,[(0,a.bF)(d,{onClick:e.editProfile,color:"primary",size:"small",icon:"edit",class:"edit-profile-button",block:""},{default:(0,a.k6)(()=>t[4]||(t[4]=[(0,a.eW)(" Edit Profile ")])),_:1,__:[4]},8,["onClick"]),(0,a.bF)(d,{onClick:e.logout,color:"danger",size:"small",icon:"logout",outline:"",block:""},{default:(0,a.k6)(()=>t[5]||(t[5]=[(0,a.eW)(" Logout ")])),_:1,__:[5]},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const bt=(0,a.pM)({name:"UserAvatar",emits:["edit-profile","logout"],props:{userProfile:{type:Object,required:!0}},data(){return{showDropdown:!1}},computed:{fullName(){return this.userProfile&&`${this.userProfile.firstName} ${this.userProfile.lastName}`.trim()||"User"},initials(){return this.userProfile&&this.userProfile.firstName&&this.userProfile.lastName?`${this.userProfile.firstName[0]}${this.userProfile.lastName[0]}`.toUpperCase():"U"}},methods:{toggleDropdown(){this.showDropdown=!this.showDropdown},editProfile(){this.showDropdown=!1,this.$emit("edit-profile")},logout(){this.showDropdown=!1,this.$emit("logout")}}}),wt=(0,X.A)(bt,[["render",gt]]),vt=wt,kt={class:"modal-header"},yt={class:"profile-form"},qt={class:"form-row"},Dt={class:"form-row"},Ct={class:"form-actions"};function Et(e,t,s,l,o,i){const n=(0,a.g2)("va-button"),d=(0,a.g2)("va-input"),u=(0,a.g2)("va-select"),c=(0,a.g2)("va-modal");return(0,a.uX)(),(0,a.Wv)(c,{modelValue:e.isVisible,"onUpdate:modelValue":t[8]||(t[8]=t=>e.isVisible=t),size:"medium","hide-default-actions":"","fixed-layout":"",noOutsideDismiss:""},{header:(0,a.k6)(()=>[(0,a.Lk)("div",kt,[t[9]||(t[9]=(0,a.Lk)("h4",{class:"modal-title"},"User Profile",-1)),(0,a.bF)(n,{onClick:t[0]||(t[0]=t=>e.$emit("close")),icon:"close",preset:"plain",class:"close-button"})])]),default:(0,a.k6)(()=>[(0,a.Lk)("form",{onSubmit:t[7]||(t[7]=(0,r.D$)((...t)=>e.handleSubmit&&e.handleSubmit(...t),["prevent"]))},[(0,a.Lk)("div",yt,[(0,a.Lk)("div",qt,[(0,a.bF)(d,{modelValue:e.form.firstName,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.firstName=t),label:"First Name",rules:[e.required],class:"profile-form-input"},null,8,["modelValue","rules"]),(0,a.bF)(d,{modelValue:e.form.lastName,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.lastName=t),label:"Last Name",rules:[e.required],class:"profile-form-input"},null,8,["modelValue","rules"])]),(0,a.Lk)("div",Dt,[(0,a.bF)(u,{modelValue:e.form.department,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.department=t),label:"Department",options:e.departments,rules:[e.required],class:"profile-form-input"},null,8,["modelValue","options","rules"]),(0,a.bF)(d,{modelValue:e.form.title,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.title=t),label:"Job Title",rules:[e.required],class:"profile-form-input"},null,8,["modelValue","rules"])]),(0,a.bF)(d,{modelValue:e.form.email,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.email=t),label:"Email",disabled:"",class:"email-input"},null,8,["modelValue"]),(0,a.Lk)("div",Ct,[(0,a.bF)(n,{type:"button",onClick:t[6]||(t[6]=t=>e.$emit("close")),color:"secondary",class:"cancel-button"},{default:(0,a.k6)(()=>t[10]||(t[10]=[(0,a.eW)(" Cancel ")])),_:1,__:[10]}),(0,a.bF)(n,{type:"submit",color:"primary",loading:e.isSaving,disabled:!e.isFormValid},{default:(0,a.k6)(()=>t[11]||(t[11]=[(0,a.eW)(" Save ")])),_:1,__:[11]},8,["loading","disabled"])])])],32)]),_:1},8,["modelValue"])}const Vt=(0,a.pM)({name:"UserProfileModal",emits:["close","saved"],props:{isVisible:{type:Boolean,required:!0},userProfile:{type:Object,default:null}},data(){return{isSaving:!1,departments:Be,form:{firstName:"",lastName:"",department:"",title:"",email:""}}},computed:{isFormValid(){return this.form.firstName.trim()&&this.form.lastName.trim()&&this.form.department&&this.form.title.trim()}},watch:{userProfile:{handler(e){this.form=e?{firstName:e.firstName||"",lastName:e.lastName||"",department:e.department||"",title:e.title||"",email:e.email||""}:{firstName:"",lastName:"",department:"",title:"",email:""}},immediate:!0}},methods:{required(e){return!!e?.trim()||"This field is required"},async handleSubmit(){if(this.isFormValid){this.isSaving=!0;try{this.$emit("saved",{firstName:this.form.firstName.trim(),lastName:this.form.lastName.trim(),department:this.form.department,title:this.form.title.trim()})}catch(e){console.error("Error in form submission:",e)}finally{this.isSaving=!1}}}}}),Ft=(0,X.A)(Vt,[["render",Et]]),_t=Ft,At={class:"modal-header"},Lt={class:"user-management"},Ut={class:"form-row"},Rt={class:"form-field"},St={class:"form-field"},xt={class:"form-row"},Pt={class:"form-field"},Nt={class:"form-field"},It={class:"form-row"},Mt={class:"form-field"},Tt={class:"form-field"},Ot={class:"form-actions"},Wt={class:"table-actions"},Bt={class:"confirmation-dialog"},zt={class:"dialog-actions"};function Xt(e,t,s,l,i,n){const d=(0,a.g2)("va-button"),u=(0,a.g2)("va-card-title"),c=(0,a.g2)("va-input"),m=(0,a.g2)("va-select"),h=(0,a.g2)("va-card-content"),p=(0,a.g2)("va-card"),f=(0,a.g2)("va-data-table"),g=(0,a.g2)("va-modal");return(0,a.uX)(),(0,a.Wv)(g,{modelValue:e.isVisible,"onUpdate:modelValue":t[12]||(t[12]=t=>e.isVisible=t),size:"large","hide-default-actions":"","fixed-layout":"",noOutsideDismiss:""},{header:(0,a.k6)(()=>[(0,a.Lk)("div",At,[t[14]||(t[14]=(0,a.Lk)("h4",{class:"modal-title"},"System Users",-1)),(0,a.bF)(d,{onClick:t[0]||(t[0]=t=>e.showAddUserForm=!0),color:"primary",icon:"add",class:"add-user-button"},{default:(0,a.k6)(()=>t[13]||(t[13]=[(0,a.eW)(" Add User ")])),_:1,__:[13]}),(0,a.bF)(d,{onClick:t[1]||(t[1]=t=>e.isVisible=!1),icon:"close",preset:"plain",class:"close-button"})])]),default:(0,a.k6)(()=>[(0,a.Lk)("div",Lt,[e.showAddUserForm?((0,a.uX)(),(0,a.Wv)(p,{key:0,class:"add-user-form"},{default:(0,a.k6)(()=>[(0,a.bF)(u,null,{default:(0,a.k6)(()=>t[15]||(t[15]=[(0,a.eW)("Add New User")])),_:1,__:[15]}),(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.Lk)("form",{onSubmit:t[9]||(t[9]=(0,r.D$)((...t)=>e.handleAddUser&&e.handleAddUser(...t),["prevent"]))},[(0,a.Lk)("div",Ut,[(0,a.Lk)("div",Rt,[(0,a.bF)(c,{modelValue:e.newUser.email,"onUpdate:modelValue":t[2]||(t[2]=t=>e.newUser.email=t),label:"Email",type:"email",rules:[e.required,e.email],class:"field-input"},null,8,["modelValue","rules"])]),(0,a.Lk)("div",St,[(0,a.bF)(c,{modelValue:e.newUser.firstName,"onUpdate:modelValue":t[3]||(t[3]=t=>e.newUser.firstName=t),label:"First Name",rules:[e.required],class:"field-input"},null,8,["modelValue","rules"])])]),(0,a.Lk)("div",xt,[(0,a.Lk)("div",Pt,[(0,a.bF)(c,{modelValue:e.newUser.lastName,"onUpdate:modelValue":t[4]||(t[4]=t=>e.newUser.lastName=t),label:"Last Name",rules:[e.required],class:"field-input"},null,8,["modelValue","rules"])]),(0,a.Lk)("div",Nt,[(0,a.bF)(m,{modelValue:e.newUser.department,"onUpdate:modelValue":t[5]||(t[5]=t=>e.newUser.department=t),label:"Department",options:e.departments,rules:[e.requiredSelect],class:"field-input"},null,8,["modelValue","options","rules"])])]),(0,a.Lk)("div",It,[(0,a.Lk)("div",Mt,[(0,a.bF)(c,{modelValue:e.newUser.title,"onUpdate:modelValue":t[6]||(t[6]=t=>e.newUser.title=t),label:"Job Title",rules:[e.required],class:"field-input"},null,8,["modelValue","rules"])]),(0,a.Lk)("div",Tt,[(0,a.bF)(m,{modelValue:e.newUser.role,"onUpdate:modelValue":t[7]||(t[7]=t=>e.newUser.role=t),options:e.roleOptions,"value-by":"value","text-by":"text",label:"Role",rules:[e.requiredSelect],class:"field-input"},null,8,["modelValue","options","rules"])])]),(0,a.Lk)("div",Ot,[(0,a.bF)(d,{onClick:t[8]||(t[8]=t=>e.showAddUserForm=!1),color:"secondary",class:"cancel-button"},{default:(0,a.k6)(()=>t[16]||(t[16]=[(0,a.eW)(" Cancel ")])),_:1,__:[16]}),(0,a.bF)(d,{type:"submit",color:"primary",loading:e.addingUser,disabled:!e.isNewUserFormValid},{default:(0,a.k6)(()=>t[17]||(t[17]=[(0,a.eW)(" Add User ")])),_:1,__:[17]},8,["loading","disabled"])])],32)]),_:1})]),_:1})):(0,a.Q3)("",!0),(0,a.bF)(f,{items:e.users,columns:e.columns,loading:e.loading,striped:""},{"cell(name)":(0,a.k6)(({rowData:e})=>[(0,a.eW)((0,o.v_)(e.firstName)+" "+(0,o.v_)(e.lastName),1)]),"cell(actions)":(0,a.k6)(({rowData:t})=>[(0,a.Lk)("div",Wt,[(0,a.bF)(m,{modelValue:t.role,"onUpdate:modelValue":[e=>t.role=e,s=>e.updateUserRole(t.uid,s)],options:e.roleOptions,"value-by":"value","text-by":"text",size:"small",class:"role-select"},null,8,["modelValue","onUpdate:modelValue","options"]),(0,a.bF)(d,{onClick:s=>e.confirmDeleteUser(t.uid),color:"danger",icon:"delete",size:"small",preset:"plain",disabled:t.uid===e.currentUserId},null,8,["onClick","disabled"])])]),_:1},8,["items","columns","loading"]),(0,a.bF)(g,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":t[11]||(t[11]=t=>e.showDeleteDialog=t),title:"Confirm Delete",size:"small","hide-default-actions":"","fixed-layout":"",noOutsideDismiss:""},{default:(0,a.k6)(()=>[(0,a.Lk)("div",Bt,[t[20]||(t[20]=(0,a.Lk)("p",null," Are you sure you want to delete this user? This action cannot be undone. ",-1)),(0,a.Lk)("div",zt,[(0,a.bF)(d,{onClick:t[10]||(t[10]=t=>e.showDeleteDialog=!1),color:"secondary",class:"cancel-button"},{default:(0,a.k6)(()=>t[18]||(t[18]=[(0,a.eW)(" Cancel ")])),_:1,__:[18]}),(0,a.bF)(d,{onClick:e.deleteUser,color:"danger",loading:e.deletingUser},{default:(0,a.k6)(()=>t[19]||(t[19]=[(0,a.eW)(" Delete ")])),_:1,__:[19]},8,["onClick","loading"])])])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}const Qt=(0,a.pM)({name:"UserManagementModal",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],data(){return{users:[],loading:!1,showAddUserForm:!1,addingUser:!1,showDeleteDialog:!1,deletingUser:!1,userToDelete:null,newUser:{email:"",firstName:"",lastName:"",department:"",title:"",role:"user"},roleOptions:[{value:"viewer",text:"Viewer"},{value:"user",text:"User"},{value:"admin",text:"Admin"}],departments:Be,columns:[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"department",label:"Department"},{key:"title",label:"Job Title"},{key:"role",label:"Role"}]}},computed:{isVisible:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},currentUserId(){return ie()?.uid},isNewUserFormValid(){return this.newUser.email&&this.newUser.firstName&&this.newUser.lastName&&this.newUser.department&&this.newUser.title&&this.newUser.role}},watch:{modelValue(e){e&&this.loadUsers()}},methods:{async loadUsers(){this.loading=!0;try{this.users=await he()}catch(e){console.error("Error loading users:",e),this.$vaToast.init({message:"Error loading users",color:"danger"})}finally{this.loading=!1}},async handleAddUser(){if(this.isNewUserFormValid){this.addingUser=!0;try{await pe(this.newUser.email,"123456",{firstName:this.newUser.firstName,lastName:this.newUser.lastName,department:this.newUser.department,title:this.newUser.title,role:this.newUser.role}),this.$vaToast.init({message:"User created successfully",color:"success"}),this.resetNewUserForm(),this.showAddUserForm=!1,await this.loadUsers()}catch(e){console.error("Error creating user:",e),this.$vaToast.init({message:"Error creating user: "+(e instanceof Error?e.message:"Unknown error"),color:"danger"})}finally{this.addingUser=!1}}},async updateUserRole(e,t){try{await fe(e,t),this.$vaToast.init({message:"User role updated successfully",color:"success"})}catch(s){console.error("Error updating user role:",s),this.$vaToast.init({message:"Error updating user role",color:"danger"}),await this.loadUsers()}},confirmDeleteUser(e){this.userToDelete=e,this.showDeleteDialog=!0},async deleteUser(){if(this.userToDelete){this.deletingUser=!0;try{await ge(this.userToDelete),this.$vaToast.init({message:"User deleted successfully",color:"success"}),await this.loadUsers()}catch(e){console.error("Error deleting user:",e),this.$vaToast.init({message:"Error deleting user",color:"danger"})}finally{this.deletingUser=!1,this.showDeleteDialog=!1,this.userToDelete=null}}},resetNewUserForm(){this.newUser={email:"",firstName:"",lastName:"",department:"",title:"",role:"user"}},getRoleColor(e){switch(e){case"admin":return"danger";case"user":return"primary";case"viewer":return"secondary";default:return"secondary"}},getRoleLabel(e){switch(e){case"admin":return"Admin";case"user":return"User";case"viewer":return"Viewer";default:return"Unknown"}},close(){this.isVisible=!1},required(e){return!!e||"This field is required"},requiredSelect(e){return!!e||"This field is required"},email(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)||"Please enter a valid email address"}}}),Ht=(0,X.A)(Qt,[["render",Xt]]),Gt=Ht,Zt={class:"modal-header"},Jt={class:"header-actions"},$t={key:0,class:"status-container"},jt={key:0},Kt={class:"request-header"},Yt={class:"request-id-title"},es={class:"request-id"},ts={class:"request-field"},ss={class:"request-field"},rs={class:"request-field"},as={class:"request-field"},ls={class:"request-field"},os={class:"request-field"},is={key:0,class:"request-actions"},ns={class:"comments-section"},ds={key:0,class:"comments-loading"},us={key:1,class:"comments-list"},cs={class:"comment-content"},ms={class:"comment-header"},hs={class:"comment-author"},ps={class:"comment-date"},fs={key:1,class:"edited-badge"},gs={key:0,class:"comment-edit-form"},bs={class:"comment-edit-actions"},ws={key:2},vs={key:4,class:"view-only-message"},ks={class:"confirmation-dialog"},ys={class:"dialog-actions"},qs={class:"confirmation-dialog"},Ds={class:"dialog-actions"};function Cs(e,t,s,r,l,i){const n=(0,a.g2)("va-badge"),d=(0,a.g2)("va-button"),u=(0,a.g2)("va-card-title"),c=(0,a.g2)("va-select"),m=(0,a.g2)("va-progress-circle"),h=(0,a.g2)("va-icon"),p=(0,a.g2)("va-list-item-section"),f=(0,a.g2)("va-list-item"),g=(0,a.g2)("va-list"),b=(0,a.g2)("va-dropdown-content"),w=(0,a.g2)("va-dropdown"),v=(0,a.g2)("va-textarea"),k=(0,a.g2)("va-card-content"),y=(0,a.g2)("va-card"),q=(0,a.g2)("AddComment"),D=(0,a.g2)("va-modal");return(0,a.uX)(),(0,a.Wv)(D,{modelValue:e.isVisible,"onUpdate:modelValue":t[6]||(t[6]=t=>e.isVisible=t),size:"large","hide-default-actions":"","fixed-layout":"",noOutsideDismiss:""},{header:(0,a.k6)(()=>[(0,a.Lk)("div",Zt,[t[8]||(t[8]=(0,a.Lk)("h4",{class:"modal-title"},"Request Details",-1)),(0,a.Lk)("div",Jt,[e.request?((0,a.uX)(),(0,a.CE)("div",$t,[t[7]||(t[7]=(0,a.Lk)("span",{class:"status-label"},"Status:",-1)),(0,a.bF)(n,{color:e.getStatusColor(e.request.status),text:e.request.status,class:"status-badge-header"},null,8,["color","text"])])):(0,a.Q3)("",!0),(0,a.bF)(d,{onClick:e.closeModal,icon:"close",preset:"plain",class:"close-button"},null,8,["onClick"])])])]),default:(0,a.k6)(()=>[e.request?((0,a.uX)(),(0,a.CE)("div",jt,[(0,a.bF)(y,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",Kt,[(0,a.Lk)("div",Yt,[(0,a.Lk)("div",es,"#"+(0,o.v_)(e.request.requestNumber),1),(0,a.bF)(u,{class:"request-title-wrap"},{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)(e.request.title),1)]),_:1})])]),(0,a.bF)(k,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",ts,[t[9]||(t[9]=(0,a.Lk)("strong",null,"Status:",-1)),(0,a.bF)(c,{modelValue:e.editableStatus,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.editableStatus=t),e.updateStatus],options:e.statusOptions,class:"status-select"},null,8,["modelValue","options","onUpdate:modelValue"])]),(0,a.Lk)("div",ss,[t[10]||(t[10]=(0,a.Lk)("strong",null,"Sender:",-1)),(0,a.eW)(" "+(0,o.v_)(e.request.senderName),1)]),(0,a.Lk)("div",rs,[t[11]||(t[11]=(0,a.Lk)("strong",null,"Sender Department:",-1)),(0,a.eW)(" "+(0,o.v_)(e.request.senderDepartment),1)]),(0,a.Lk)("div",as,[t[12]||(t[12]=(0,a.Lk)("strong",null,"Receiver Department:",-1)),(0,a.eW)(" "+(0,o.v_)(e.request.receiverDepartment),1)]),(0,a.Lk)("div",ls,[t[13]||(t[13]=(0,a.Lk)("strong",null,"Created:",-1)),(0,a.eW)(" "+(0,o.v_)(e.formatDate(e.request.createdAt)),1)]),(0,a.Lk)("div",os,[t[14]||(t[14]=(0,a.Lk)("strong",null,"Description:",-1)),(0,a.Lk)("p",null,(0,o.v_)(e.request.details),1)]),e.isViewOnly?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",is,[(0,a.bF)(d,{onClick:e.enableEdit,color:"primary",icon:"edit",size:"small",class:"edit-button"},{default:(0,a.k6)(()=>t[15]||(t[15]=[(0,a.eW)(" Edit Request ")])),_:1,__:[15]},8,["onClick"]),e.canDelete||e.canDeleteAll||e.request.senderId===e.currentUserId?((0,a.uX)(),(0,a.Wv)(d,{key:0,onClick:e.confirmDelete,color:"danger",icon:"delete",size:"small"},{default:(0,a.k6)(()=>t[16]||(t[16]=[(0,a.eW)(" Delete Request ")])),_:1,__:[16]},8,["onClick"])):(0,a.Q3)("",!0)])),(0,a.Lk)("div",ns,[t[24]||(t[24]=(0,a.Lk)("h4",null,"Comments",-1)),e.isLoadingComments?((0,a.uX)(),(0,a.CE)("div",ds,[(0,a.bF)(m,{indeterminate:"",size:"small"}),t[17]||(t[17]=(0,a.Lk)("span",{class:"loading-text"},"Loading comments...",-1))])):e.comments.length>0?((0,a.uX)(),(0,a.CE)("div",us,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.comments,s=>((0,a.uX)(),(0,a.CE)("div",{key:s.id,class:(0,o.C4)(["comment-item",{"system-comment":s.isSystemComment}])},[(0,a.bF)(y,{class:(0,o.C4)({"system-comment-card":s.isSystemComment})},{default:(0,a.k6)(()=>[(0,a.bF)(k,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",cs,[(0,a.Lk)("div",ms,[(0,a.Lk)("div",hs,[s.isSystemComment?((0,a.uX)(),(0,a.Wv)(h,{key:0,name:"settings",size:"small",class:"system-comment-icon"})):(0,a.Q3)("",!0),(0,a.Lk)("strong",null,(0,o.v_)(s.authorName),1),(0,a.Lk)("span",ps,(0,o.v_)(e.formatDate(s.createdAt)),1),s.isEdited?((0,a.uX)(),(0,a.CE)("span",fs," (edited) ")):(0,a.Q3)("",!0)]),e.isViewOnly||s.isSystemComment||s.authorId!==e.currentUserId?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.Wv)(w,{key:0,class:"comment-menu",placement:"bottom-end"},{anchor:(0,a.k6)(()=>[(0,a.bF)(d,{icon:"more_vert",preset:"plain",size:"small",class:"comment-menu-button"})]),default:(0,a.k6)(()=>[(0,a.bF)(b,null,{default:(0,a.k6)(()=>[(0,a.bF)(g,null,{default:(0,a.k6)(()=>[(0,a.bF)(f,{onClick:t=>e.startEditComment(s),class:"dropdown-item"},{default:(0,a.k6)(()=>[(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(h,{name:"edit",size:"small"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>t[18]||(t[18]=[(0,a.eW)(" Edit ")])),_:1,__:[18]})]),_:2},1032,["onClick"]),(0,a.bF)(f,{onClick:t=>e.confirmDeleteComment(s.id),class:"dropdown-item danger"},{default:(0,a.k6)(()=>[(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.bF)(h,{name:"delete",size:"small"})]),_:1}),(0,a.bF)(p,null,{default:(0,a.k6)(()=>t[19]||(t[19]=[(0,a.eW)(" Delete ")])),_:1,__:[19]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))]),e.editingCommentId===s.id?((0,a.uX)(),(0,a.CE)("div",gs,[(0,a.bF)(v,{modelValue:e.editCommentText,"onUpdate:modelValue":t[1]||(t[1]=t=>e.editCommentText=t),placeholder:"Edit your comment...",rows:3,class:"comment-edit-input"},null,8,["modelValue"]),(0,a.Lk)("div",bs,[(0,a.bF)(d,{onClick:e.cancelEditComment,color:"secondary",size:"small",class:"cancel-edit-btn"},{default:(0,a.k6)(()=>t[20]||(t[20]=[(0,a.eW)(" Cancel ")])),_:1,__:[20]},8,["onClick"]),(0,a.bF)(d,{onClick:e.saveEditComment,color:"primary",size:"small",loading:e.savingComment,disabled:!e.editCommentText.trim(),class:"save-edit-btn"},{default:(0,a.k6)(()=>t[21]||(t[21]=[(0,a.eW)(" Save ")])),_:1,__:[21]},8,["onClick","loading","disabled"])])])):((0,a.uX)(),(0,a.CE)("p",{key:1,class:(0,o.C4)({"system-comment-text":s.isSystemComment})},(0,o.v_)(s.text),3))])]),_:2},1024)]),_:2},1032,["class"])],2))),128))])):((0,a.uX)(),(0,a.CE)("div",ws,t[22]||(t[22]=[(0,a.Lk)("p",{class:"no-comments"},"No comments yet.",-1)]))),e.canComment?((0,a.uX)(),(0,a.Wv)(q,{key:3,isSubmittingComment:e.isSubmittingComment,onSubmit:e.handleComment},null,8,["isSubmittingComment","onSubmit"])):e.isViewOnly?((0,a.uX)(),(0,a.CE)("div",vs,t[23]||(t[23]=[(0,a.Lk)("p",null,[(0,a.Lk)("em",null,"You have view-only access and cannot add comments.")],-1)]))):(0,a.Q3)("",!0)])]),_:1})]),_:1})])):(0,a.Q3)("",!0),(0,a.bF)(D,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":t[3]||(t[3]=t=>e.showDeleteDialog=t),title:"Confirm Delete",size:"small",hideDefaultActions:!0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",ks,[t[27]||(t[27]=(0,a.Lk)("p",null," Are you sure you want to delete this request? This action cannot be undone. ",-1)),(0,a.Lk)("div",ys,[(0,a.bF)(d,{onClick:t[2]||(t[2]=t=>e.showDeleteDialog=!1),color:"secondary",class:"cancel-button"},{default:(0,a.k6)(()=>t[25]||(t[25]=[(0,a.eW)(" Cancel ")])),_:1,__:[25]}),(0,a.bF)(d,{onClick:e.deleteRequest,color:"danger",loading:e.deletingRequest},{default:(0,a.k6)(()=>t[26]||(t[26]=[(0,a.eW)(" Delete ")])),_:1,__:[26]},8,["onClick","loading"])])])]),_:1},8,["modelValue"]),(0,a.bF)(D,{modelValue:e.showDeleteCommentDialog,"onUpdate:modelValue":t[5]||(t[5]=t=>e.showDeleteCommentDialog=t),title:"Confirm Delete",size:"small",hideDefaultActions:!0},{default:(0,a.k6)(()=>[(0,a.Lk)("div",qs,[t[30]||(t[30]=(0,a.Lk)("p",null," Are you sure you want to delete this comment? This action cannot be undone. ",-1)),(0,a.Lk)("div",Ds,[(0,a.bF)(d,{onClick:t[4]||(t[4]=t=>e.showDeleteCommentDialog=!1),color:"secondary",class:"cancel-button"},{default:(0,a.k6)(()=>t[28]||(t[28]=[(0,a.eW)(" Cancel ")])),_:1,__:[28]}),(0,a.bF)(d,{onClick:e.deleteComment,color:"danger",loading:e.deletingComment},{default:(0,a.k6)(()=>t[29]||(t[29]=[(0,a.eW)(" Delete ")])),_:1,__:[29]},8,["onClick","loading"])])])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}const Es=(0,a.pM)({name:"RequestDetailsModal",components:{AddComment:H},props:{modelValue:{type:Boolean,default:!1},request:{type:Object,default:null},comments:{type:Array,default:()=>[]},isViewOnly:{type:Boolean,default:!1},canComment:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canDeleteAll:{type:Boolean,default:!1},currentUserId:{type:String,default:""}},emits:["update:modelValue","comment-added","comment-deleted","request-updated","request-deleted","edit-request","reload-data"],data(){return{isSubmittingComment:!1,showDeleteDialog:!1,showDeleteCommentDialog:!1,deletingRequest:!1,deletingComment:!1,commentToDelete:null,editableStatus:"",statusOptions:["Open","In-Progress","Closed"],isLoadingComments:!1,editingCommentId:null,editCommentText:"",savingComment:!1}},computed:{isVisible:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},watch:{request:{handler(e){e&&(this.editableStatus=e.status)},immediate:!0}},methods:{closeModal(){this.isVisible=!1},enableEdit(){this.$emit("edit-request",this.request)},async updateStatus(e){if(!this.request||e===this.request.status)return;const t=this.request.status;this.isLoadingComments=!0;try{await Ve(this.request.id,{status:e}),await Ae(this.request.id,`Status changed from "${t}" to "${e}"`),this.$vaToast.init({message:"Status updated successfully",color:"success"}),this.$emit("request-updated"),this.$emit("reload-data")}catch(s){console.error("Error updating status:",s),this.$vaToast.init({message:"Error updating status",color:"danger"}),this.editableStatus=this.request.status}finally{this.isLoadingComments=!1}},confirmDelete(){this.showDeleteDialog=!0},async deleteRequest(){if(this.request){this.deletingRequest=!0;try{await Ee(this.request.id),this.$vaToast.init({message:"Request deleted successfully",color:"success"}),this.showDeleteDialog=!1,this.closeModal(),this.$emit("request-deleted"),this.$emit("reload-data")}catch(e){console.error("Error deleting request:",e),this.$vaToast.init({message:"Error deleting request",color:"danger"})}finally{this.deletingRequest=!1}}},async handleComment(e){if(this.request){this.isSubmittingComment=!0;try{this.$emit("comment-added",this.request.id,e),this.$emit("reload-data")}catch(t){console.error("Error adding comment:",t),this.$vaToast.init({message:"Error adding comment",color:"danger"})}finally{this.isSubmittingComment=!1}}},confirmDeleteComment(e){this.commentToDelete=e,this.showDeleteCommentDialog=!0},async deleteComment(){if(this.request&&this.commentToDelete){this.deletingComment=!0;try{await _e(this.request.id,this.commentToDelete),this.$vaToast.init({message:"Comment deleted successfully",color:"success"}),this.showDeleteCommentDialog=!1,this.commentToDelete=null,this.$emit("comment-deleted"),this.$emit("reload-data")}catch(e){console.error("Error deleting comment:",e),this.$vaToast.init({message:"Error deleting comment",color:"danger"})}finally{this.deletingComment=!1}}},startEditComment(e){this.editingCommentId=e.id,this.editCommentText=e.text},cancelEditComment(){this.editingCommentId=null,this.editCommentText=""},async saveEditComment(){if(this.request&&this.editingCommentId&&this.editCommentText.trim()){this.savingComment=!0;try{await Le(this.request.id,this.editingCommentId,this.editCommentText.trim()),this.$vaToast.init({message:"Comment updated successfully",color:"success"}),this.cancelEditComment(),this.$emit("reload-data")}catch(e){console.error("Error updating comment:",e),this.$vaToast.init({message:"Error updating comment",color:"danger"})}finally{this.savingComment=!1}}},formatDate(e){return new Date(e).toLocaleString()},getStatusColor(e){return Ue(e)}}}),Vs=(0,X.A)(Es,[["render",Cs]]),Fs=Vs,_s={class:"modal-header"},As={class:"header-actions"},Ls={class:"export-modal-content"},Us={class:"export-fields"},Rs={class:"export-field-item"},Ss={class:"drag-handle"},xs={class:"export-options"},Ps={key:0,class:"date-range-options"},Ns={class:"date-range-inputs"};function Is(e,t,s,r,l,o){const i=(0,a.g2)("va-button"),n=(0,a.g2)("va-icon"),d=(0,a.g2)("va-checkbox"),u=(0,a.g2)("draggable"),c=(0,a.g2)("va-date-input"),m=(0,a.g2)("va-modal");return(0,a.uX)(),(0,a.Wv)(m,{modelValue:e.isVisible,"onUpdate:modelValue":t[7]||(t[7]=t=>e.isVisible=t),size:"medium","max-width":"600px","hide-default-actions":"","fixed-layout":"",noOutsideDismiss:""},{header:(0,a.k6)(()=>[(0,a.Lk)("div",_s,[t[8]||(t[8]=(0,a.Lk)("h4",{class:"modal-title"},"Export Requests to Excel",-1)),(0,a.Lk)("div",As,[(0,a.bF)(i,{onClick:t[0]||(t[0]=t=>e.isVisible=!1),icon:"close",preset:"plain",class:"close-button"})])])]),footer:(0,a.k6)(()=>[(0,a.bF)(i,{onClick:e.closeModal,preset:"secondary",class:"cancel-button"},{default:(0,a.k6)(()=>t[12]||(t[12]=[(0,a.eW)(" Cancel ")])),_:1,__:[12]},8,["onClick"]),(0,a.bF)(i,{onClick:e.exportToExcel,color:"primary",loading:e.exportLoading,disabled:!e.hasSelectedFields,"border-color":"primary",class:"export-button"},{default:(0,a.k6)(()=>t[13]||(t[13]=[(0,a.eW)(" Export Excel ")])),_:1,__:[13]},8,["onClick","loading","disabled"])]),default:(0,a.k6)(()=>[(0,a.Lk)("div",Ls,[t[11]||(t[11]=(0,a.Lk)("p",{class:"export-description"}," Select the fields you want to include in the Excel export: ",-1)),(0,a.Lk)("div",Us,[t[9]||(t[9]=(0,a.Lk)("h5",{class:"fields-title"},"Select and reorder export fields:",-1)),(0,a.bF)(u,{modelValue:e.sortedExportFields,"onUpdate:modelValue":t[1]||(t[1]=t=>e.sortedExportFields=t),"item-key":"key",class:"draggable-fields",handle:".drag-handle",animation:150,"ghost-class":"ghost","chosen-class":"chosen","drag-class":"drag"},{item:(0,a.k6)(({element:e})=>[(0,a.Lk)("div",Rs,[(0,a.Lk)("div",Ss,[(0,a.bF)(n,{name:"drag_indicator"})]),(0,a.bF)(d,{modelValue:e.selected,"onUpdate:modelValue":t=>e.selected=t,label:e.label,class:"export-field-checkbox"},null,8,["modelValue","onUpdate:modelValue","label"])])]),_:1},8,["modelValue"])]),(0,a.Lk)("div",xs,[(0,a.bF)(d,{modelValue:e.includeComments,"onUpdate:modelValue":t[2]||(t[2]=t=>e.includeComments=t),label:"Include Comments",class:"export-option-checkbox"},null,8,["modelValue"]),(0,a.bF)(d,{modelValue:e.applyCurrentFilters,"onUpdate:modelValue":t[3]||(t[3]=t=>e.applyCurrentFilters=t),label:"Apply Current Filters",class:"export-option-checkbox"},null,8,["modelValue"]),(0,a.bF)(d,{modelValue:e.useDateRange,"onUpdate:modelValue":t[4]||(t[4]=t=>e.useDateRange=t),label:"Filter by Date Range",class:"export-option-checkbox"},null,8,["modelValue"])]),e.useDateRange?((0,a.uX)(),(0,a.CE)("div",Ps,[t[10]||(t[10]=(0,a.Lk)("h5",{class:"date-range-title"},"Date Range Filter",-1)),(0,a.Lk)("div",Ns,[(0,a.bF)(c,{modelValue:e.dateFrom,"onUpdate:modelValue":t[5]||(t[5]=t=>e.dateFrom=t),label:"From Date",class:"date-input",clearable:""},null,8,["modelValue"]),(0,a.bF)(c,{modelValue:e.dateTo,"onUpdate:modelValue":t[6]||(t[6]=t=>e.dateTo=t),label:"To Date",class:"date-input",clearable:""},null,8,["modelValue"])])])):(0,a.Q3)("",!0)])]),_:1},8,["modelValue"])}var Ms=s(432),Ts=s.n(Ms);const Os=(0,a.pM)({name:"ExportModal",components:{draggable:Ts()},props:{modelValue:{type:Boolean,default:!1},requests:{type:Array,default:()=>[]},currentFilters:{type:Object,default:()=>({})}},emits:["update:modelValue"],data(){return{exportLoading:!1,includeComments:!1,applyCurrentFilters:!0,useDateRange:!1,dateFrom:null,dateTo:null,exportFields:[{key:"title",label:"Request Title",selected:!0,order:1},{key:"senderName",label:"Requestor Name",selected:!0,order:2},{key:"senderDepartment",label:"Requestor Department",selected:!0,order:3},{key:"receiverDepartment",label:"Assigned Department",selected:!0,order:4},{key:"status",label:"Status",selected:!0,order:5},{key:"details",label:"Description",selected:!0,order:6},{key:"createdAt",label:"Date Created",selected:!0,order:7},{key:"updatedAt",label:"Date Modified",selected:!1,order:8}]}},computed:{isVisible:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},hasSelectedFields(){return this.exportFields.some(e=>e.selected)},sortedExportFields:{get(){return[...this.exportFields].sort((e,t)=>e.order-t.order)},set(e){e.forEach((e,t)=>{e.order=t+1}),this.exportFields=e}},requestsToExport(){let e=[...this.requests];return this.applyCurrentFilters&&this.currentFilters&&(e=e.filter(e=>{const t=!this.currentFilters.status||"All"===this.currentFilters.status||e.status===this.currentFilters.status,s=!this.currentFilters.senderDepartment||"All Sender Departments"===this.currentFilters.senderDepartment||e.senderDepartment===this.currentFilters.senderDepartment,r=!this.currentFilters.receiverDepartment||"All Receiver Departments"===this.currentFilters.receiverDepartment||e.receiverDepartment===this.currentFilters.receiverDepartment,a=!this.currentFilters.search||e.title?.toLowerCase()?.includes(this.currentFilters.search?.toLowerCase())||e.details?.toLowerCase()?.includes(this.currentFilters.search?.toLowerCase())||e.senderName?.toLowerCase()?.includes(this.currentFilters.search?.toLowerCase());return t&&s&&r&&a})),this.useDateRange&&(e=e.filter(e=>{const t=e.createdAt,s=!this.dateFrom||t>=this.dateFrom.getTime(),r=!this.dateTo||t<=this.dateTo.getTime();return s&&r})),e}},methods:{closeModal(){this.isVisible=!1},async exportToExcel(){this.exportLoading=!0;try{const e=this.requestsToExport;if(0===e.length)return void this.$vaToast.init({message:"No data to export based on selected filters",color:"warning"});const t=this.sortedExportFields.filter(e=>e.selected),r=e.map(e=>{const s={};return t.forEach(t=>{"createdAt"===t.key||"updatedAt"===t.key?s[t.label]=e[t.key]?new Date(e[t.key]).toLocaleString():"":s[t.label]=e[t.key]||""}),s}),a=await s.e(959).then(s.bind(s,959)),l=a.utils.json_to_sheet(r),o=a.utils.book_new();a.utils.book_append_sheet(o,l,"Requests");const i=`requests-export-${(new Date).toISOString().split("T")[0]}.xlsx`;a.writeFile(o,i),this.$vaToast.init({message:"Excel file exported successfully",color:"success"}),this.closeModal()}catch(e){console.error("Error exporting to Excel:",e),this.$vaToast.init({message:"Error exporting to Excel",color:"danger"})}finally{this.exportLoading=!1}}}}),Ws=(0,X.A)(Os,[["render",Is]]),Bs=Ws,zs={class:"modal-header"},Xs={key:0},Qs={class:"form-actions"};function Hs(e,t,s,l,o,i){const n=(0,a.g2)("va-button"),d=(0,a.g2)("va-input"),u=(0,a.g2)("va-select"),c=(0,a.g2)("va-textarea"),m=(0,a.g2)("va-card-content"),h=(0,a.g2)("va-card"),p=(0,a.g2)("va-modal");return(0,a.uX)(),(0,a.Wv)(p,{modelValue:e.isVisible,"onUpdate:modelValue":t[4]||(t[4]=t=>e.isVisible=t),title:"Edit Request",size:"large","hide-default-actions":"","fixed-layout":"",noOutsideDismiss:""},{header:(0,a.k6)(()=>[(0,a.Lk)("div",zs,[t[5]||(t[5]=(0,a.Lk)("h4",{class:"modal-title"},"Edit Request",-1)),(0,a.bF)(n,{onClick:e.closeModal,icon:"close",preset:"plain",class:"close-button"},null,8,["onClick"])])]),default:(0,a.k6)(()=>[e.request?((0,a.uX)(),(0,a.CE)("div",Xs,[(0,a.bF)(h,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[(0,a.Lk)("form",{onSubmit:t[3]||(t[3]=(0,r.D$)((...t)=>e.saveChanges&&e.saveChanges(...t),["prevent"])),class:"request-form"},[(0,a.bF)(d,{modelValue:e.editForm.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.editForm.title=t),label:"Request Title",rules:[e.required],class:"form-input"},null,8,["modelValue","rules"]),(0,a.bF)(u,{modelValue:e.editForm.receiverDepartment,"onUpdate:modelValue":t[1]||(t[1]=t=>e.editForm.receiverDepartment=t),label:"Receiver Department",options:e.departments,rules:[e.required],class:"form-input"},null,8,["modelValue","options","rules"]),(0,a.bF)(c,{modelValue:e.editForm.details,"onUpdate:modelValue":t[2]||(t[2]=t=>e.editForm.details=t),label:"Request Details",rows:4,class:"form-textarea"},null,8,["modelValue"]),(0,a.Lk)("div",Qs,[(0,a.bF)(n,{onClick:e.closeModal,color:"secondary",class:"cancel-button"},{default:(0,a.k6)(()=>t[6]||(t[6]=[(0,a.eW)(" Cancel ")])),_:1,__:[6]},8,["onClick"]),(0,a.bF)(n,{type:"submit",color:"primary",loading:e.saving,disabled:!e.isFormValid},{default:(0,a.k6)(()=>t[7]||(t[7]=[(0,a.eW)(" Save Changes ")])),_:1,__:[7]},8,["loading","disabled"])])],32)]),_:1})]),_:1})])):(0,a.Q3)("",!0)]),_:1},8,["modelValue"])}const Gs=(0,a.pM)({name:"EditRequestModal",props:{modelValue:{type:Boolean,default:!1},request:{type:Object,default:null}},emits:["update:modelValue","request-updated","reload-data"],data(){return{saving:!1,editForm:{title:"",receiverDepartment:"",details:"",status:""},departments:Be,statusOptions:["Open","In-Progress","Closed"]}},computed:{isVisible:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},isFormValid(){return this.editForm.title.trim()&&this.editForm.receiverDepartment&&this.editForm.details.trim()&&this.editForm.status}},watch:{request:{handler(e){e&&(this.editForm={title:e.title,receiverDepartment:e.receiverDepartment,details:e.details,status:e.status})},immediate:!0}},methods:{closeModal(){this.isVisible=!1},required(e){return!!e||"This field is required"},async saveChanges(){if(this.request&&this.isFormValid){this.saving=!0;try{await Ve(this.request.id,{title:this.editForm.title,receiverDepartment:this.editForm.receiverDepartment,details:this.editForm.details,status:this.editForm.status}),this.$vaToast.init({message:"Request updated successfully",color:"success"}),this.closeModal(),this.$emit("request-updated"),this.$emit("reload-data")}catch(e){console.error("Error updating request:",e),this.$vaToast.init({message:"Error updating request",color:"danger"})}finally{this.saving=!1}}}}}),Zs=(0,X.A)(Gs,[["render",Hs]]),Js=Zs,$s=(0,a.pM)({name:"HomePage",components:{RequestList:Ie,RequestForm:et,LoginView:it,UserAvatar:vt,UserProfileModal:_t,UserManagementModal:Gt,RequestDetailsModal:Fs,ExportModal:Bs,EditRequestModal:Js},data(){return{currentView:"home",requests:[],selectedRequest:null,selectedRequestComments:[],showRequestDetailsModal:!1,showExportModal:!1,showEditRequestModal:!1,showProfileModal:!1,showUserManagementModal:!1,filters:{status:"All",senderDepartment:"All Sender Departments",receiverDepartment:"All Receiver Departments",search:"",dateFrom:null,dateTo:null},showAdvancedFilters:!1}},computed:{departmentOptions(){return ze},senderDepartmentOptions(){return Xe},receiverDepartmentOptions(){return Qe},isAuthenticated(){return je.isAuthenticated},currentUserProfile(){return je.user},authLoading(){return je.loading},authError(){return je.error},sessionExpired(){return je.sessionExpired},canCreateRequests(){return je.canCreateRequests},canComment(){return je.canComment},canDelete(){return je.canDelete},canDeleteAll(){return je.canDeleteAll},canManageUsers(){return je.canManageUsers},isViewOnly(){return je.isViewOnly},filteredRequests(){return this.requests.filter(e=>{const t="All"===this.filters.status||e.status===this.filters.status,s="All Sender Departments"===this.filters.senderDepartment||e.senderDepartment===this.filters.senderDepartment,r="All Receiver Departments"===this.filters.receiverDepartment||e.receiverDepartment===this.filters.receiverDepartment,a=!this.filters.search||e.title?.toLowerCase()?.includes(this.filters.search?.toLowerCase())||e.details?.toLowerCase()?.includes(this.filters.search?.toLowerCase())||e.senderName?.toLowerCase()?.includes(this.filters.search?.toLowerCase())||e.senderDepartment?.toLowerCase()?.includes(this.filters.search?.toLowerCase())||e.receiverDepartment?.toLowerCase()?.includes(this.filters.search?.toLowerCase()),l=!this.filters.dateFrom||e.createdAt>=this.filters.dateFrom.getTime(),o=!this.filters.dateTo||e.createdAt<=this.filters.dateTo.getTime();return t&&s&&r&&a&&l&&o})},availableActions(){return{viewRequests:{title:"View All Requests",description:"Browse and manage action requests",icon:"list",color:"primary",buttonText:"View Requests",enabled:!0,view:"requests"},addRequest:{title:"Add New Request",description:"Create a new action request",icon:"add_circle",color:"success",buttonText:"Add Request",enabled:this.canCreateRequests,view:"add-request"},userManagement:{title:"User Management",description:"Manage users and permissions",icon:"people",color:"info",buttonText:"Manage Users",enabled:this.canManageUsers,view:"user-management"}}}},async created(){je.isAuthenticated&&await this.loadRequests()},watch:{isAuthenticated:{handler(e){e?this.loadRequests():this.requests=[]},immediate:!0}},methods:{async handleLoginSuccess(){!this.currentUserProfile||this.currentUserProfile.firstName&&this.currentUserProfile.lastName&&this.currentUserProfile.department&&this.currentUserProfile.title||(this.showProfileModal=!0)},openProfileModal(){this.showProfileModal=!0},async handleLogout(){try{await je.logout()}catch(e){console.error("Error signing out:",e)}},async handleProfileSave(e){try{await je.saveUserProfile(e),this.showProfileModal=!1}catch(t){console.error("Error saving profile:",t)}},async updateSelectedRequestData(){if(this.selectedRequest&&this.selectedRequest.id){const t=this.requests.find(e=>e.id===this.selectedRequest.id);if(t&&(this.selectedRequest=t,this.selectedRequest.id))try{this.selectedRequestComments=await De(this.selectedRequest.id)}catch(e){console.error("Error refreshing selected request comments:",e)}}},async loadRequests(){try{this.requests=await ye(),await this.updateSelectedRequestData()}catch(e){console.error("Error loading requests:",e)}},async handleNewRequest(e){try{await qe({...e,createdAt:Date.now()}),await this.loadRequests(),this.currentView="home"}catch(t){console.error("Error adding request:",t)}},async handleComment(e){try{await Fe(e.id,e.text),await this.loadRequests()}catch(t){console.error("Error adding comment:",t)}},async showRequestDetails(e){if(this.selectedRequest=e,this.showRequestDetailsModal=!0,e.id)try{this.selectedRequestComments=await De(e.id)}catch(t){console.error("Error loading comments:",t),this.selectedRequestComments=[]}},async handleCommentAdded(e,t){await this.handleComment({id:e,text:t})},async handleCommentDeleted(){await this.loadRequests()},async handleRequestUpdated(){await this.loadRequests()},async handleRequestDeleted(){await this.loadRequests(),this.showRequestDetailsModal=!1},handleEditRequest(e){this.selectedRequest=e,this.showEditRequestModal=!0},confirmDeleteRequestFromList(e){this.selectedRequest=e,this.showRequestDetailsModal=!0},selectAction(e){const t=this.availableActions,s=t[e];s&&s.enabled&&("user-management"===s.view?this.showUserManagementModal=!0:this.currentView=s.view)},openExportModal(){this.showExportModal=!0},goHome(){this.currentView="home"},async reloadRequests(){try{this.requests=await ye(),await this.updateSelectedRequestData()}catch(e){console.error("Error reloading requests:",e)}}}}),js=(0,X.A)($s,[["render",D]]),Ks=js,Ys=(0,a.pM)({name:"App",components:{HomePage:Ks}}),er=(0,X.A)(Ys,[["render",l]]),tr=er;var sr=s(857);s(951);const rr=(0,r.Ef)(tr);rr.use((0,sr.c)()),je.initialize(),rr.mount("#app")}},t={};function s(r){var a=t[r];if(void 0!==a)return a.exports;var l=t[r]={exports:{}};return e[r].call(l.exports,l,l.exports,s),l.exports}s.m=e,(()=>{var e=[];s.O=(t,r,a,l)=>{if(!r){var o=1/0;for(u=0;u<e.length;u++){for(var[r,a,l]=e[u],i=!0,n=0;n<r.length;n++)(!1&l||o>=l)&&Object.keys(s.O).every(e=>s.O[e](r[n]))?r.splice(n--,1):(i=!1,l<o&&(o=l));if(i){e.splice(u--,1);var d=a();void 0!==d&&(t=d)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[r,a,l]}})(),(()=>{s.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return s.d(t,{a:t}),t}})(),(()=>{s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce((t,r)=>(s.f[r](e,t),t),[]))})(),(()=>{s.u=e=>"js/"+e+".e7d31769.js"})(),(()=>{s.miniCssF=e=>{}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="action-tracker:";s.l=(r,a,l,o)=>{if(e[r])e[r].push(a);else{var i,n;if(void 0!==l)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==r||c.getAttribute("data-webpack")==t+l){i=c;break}}i||(n=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.setAttribute("data-webpack",t+l),i.src=r),e[r]=[a];var m=(t,s)=>{i.onerror=i.onload=null,clearTimeout(h);var a=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(s)),t)return t(s)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),n&&document.head.appendChild(i)}}})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{s.p="/action-list-tracker/"})(),(()=>{var e={524:0};s.f.j=(t,r)=>{var a=s.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var l=new Promise((s,r)=>a=e[t]=[s,r]);r.push(a[2]=l);var o=s.p+s.u(t),i=new Error,n=r=>{if(s.o(e,t)&&(a=e[t],0!==a&&(e[t]=void 0),a)){var l=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+l+": "+o+")",i.name="ChunkLoadError",i.type=l,i.request=o,a[1](i)}};s.l(o,n,"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,r)=>{var a,l,[o,i,n]=r,d=0;if(o.some(t=>0!==e[t])){for(a in i)s.o(i,a)&&(s.m[a]=i[a]);if(n)var u=n(s)}for(t&&t(r);d<o.length;d++)l=o[d],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(u)},r=self["webpackChunkaction_tracker"]=self["webpackChunkaction_tracker"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=s.O(void 0,[504],()=>s(801));r=s.O(r)})();