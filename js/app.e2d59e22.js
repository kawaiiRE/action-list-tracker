(()=>{"use strict";var e={167:(e,t,s)=>{var r=s(751),l=s(641);function a(e,t,s,r,a,o){const i=(0,l.g2)("HomePage"),n=(0,l.g2)("va-app");return(0,l.uX)(),(0,l.Wv)(n,null,{default:(0,l.k6)(()=>[(0,l.bF)(i)]),_:1})}var o=s(33);const i={key:0,class:"loading-container"},n={class:"loading-content"},d={key:2,class:"body"},u={class:"d-flex align-center"},c={key:0,class:"home-page"},m={class:"action-boxes"},h={class:"mb-2"},p={class:"text-muted"},f={key:1},g={class:"d-flex align-center mb-4"},w={class:"mb-4"},v={class:"filters-section"},b={class:"main-filters mb-3"},k={class:"advanced-filters mt-3"},y={key:2},_={class:"d-flex align-center mb-4"},E={key:0},D={class:"mb-3"},C={class:"mb-3"},U={class:"mb-3"},q={class:"mb-3"},V={class:"mb-3"},L={class:"mb-3"},A={key:0,class:"mb-4"},F={class:"mt-4"},S={key:0},R={class:"comment-meta mb-2 d-flex justify-between align-center"},x={class:"text-muted ml-2"},P={key:1},N={key:3,class:"text-muted"},I={class:"pa-4"},T={class:"d-flex justify-end mt-4"},M={class:"pa-4"},W={class:"d-flex justify-end mt-4"},O={class:"export-modal-content"},B={class:"export-fields"},X={class:"export-options mt-4"};function $(e,t,s,r,a,$){const z=(0,l.g2)("va-icon"),H=(0,l.g2)("LoginView"),j=(0,l.g2)("va-navbar-item"),K=(0,l.g2)("UserAvatar"),Q=(0,l.g2)("va-navbar"),G=(0,l.g2)("va-button"),J=(0,l.g2)("va-chip"),Y=(0,l.g2)("va-card-content"),Z=(0,l.g2)("va-card"),ee=(0,l.g2)("va-input"),te=(0,l.g2)("va-select"),se=(0,l.g2)("va-date-input"),re=(0,l.g2)("va-collapse"),le=(0,l.g2)("RequestList"),ae=(0,l.g2)("RequestForm"),oe=(0,l.g2)("va-card-title"),ie=(0,l.g2)("va-badge"),ne=(0,l.g2)("AddComment"),de=(0,l.g2)("va-modal"),ue=(0,l.g2)("va-checkbox"),ce=(0,l.g2)("va-container"),me=(0,l.g2)("UserProfileModal"),he=(0,l.g2)("UserManagementModal");return e.authLoading?((0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("div",n,[(0,l.bF)(z,{name:"autorenew",spin:"",size:"large",color:"primary"}),t[19]||(t[19]=(0,l.Lk)("p",{class:"mt-3"},"Loading...",-1))])])):e.isAuthenticated?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(Q,{color:"primary",class:"mb-4"},{left:(0,l.k6)(()=>[(0,l.bF)(j,null,{default:(0,l.k6)(()=>t[20]||(t[20]=[(0,l.Lk)("h2",null,"AZAD Properties : BAS - Project Integration",-1)])),_:1,__:[20]})]),right:(0,l.k6)(()=>[(0,l.Lk)("div",u,[(0,l.bF)(K,{"user-profile":e.currentUserProfile,onEditProfile:e.openProfileModal,onLogout:e.handleLogout},null,8,["user-profile","onEditProfile","onLogout"])])]),_:1}),(0,l.bF)(ce,{class:"main-content"},{default:(0,l.k6)(()=>["home"===e.currentView?((0,l.uX)(),(0,l.CE)("div",c,[t[22]||(t[22]=(0,l.Lk)("h2",{class:"mb-4"}," AZAD Properties : BAS - Project Integration Dashboard ",-1)),(0,l.Lk)("div",m,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.availableActions,(s,r)=>((0,l.uX)(),(0,l.Wv)(Z,{key:r,onClick:t=>e.selectAction(r),class:(0,o.C4)(["action-box",{disabled:!s.enabled}]),hover:""},{default:(0,l.k6)(()=>[(0,l.bF)(Y,{class:"text-center"},{default:(0,l.k6)(()=>[(0,l.bF)(z,{name:s.icon,size:"3rem",color:s.enabled?s.color:"secondary",class:"mb-3"},null,8,["name","color"]),(0,l.Lk)("h4",h,(0,o.v_)(s.title),1),(0,l.Lk)("p",p,(0,o.v_)(s.description),1),s.enabled?((0,l.uX)(),(0,l.Wv)(G,{key:0,color:s.color,size:"small",class:"mt-2"},{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)(s.buttonText),1)]),_:2},1032,["color"])):((0,l.uX)(),(0,l.Wv)(J,{key:1,color:"secondary",size:"small",class:"mt-2"},{default:(0,l.k6)(()=>t[21]||(t[21]=[(0,l.eW)(" No Access ")])),_:1,__:[21]}))]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))])])):(0,l.Q3)("",!0),"requests"===e.currentView?((0,l.uX)(),(0,l.CE)("div",f,[(0,l.Lk)("div",g,[(0,l.bF)(G,{onClick:e.goHome,icon:"arrow_back",preset:"plain",class:"mr-3"},{default:(0,l.k6)(()=>t[23]||(t[23]=[(0,l.eW)(" Back to Home ")])),_:1,__:[23]},8,["onClick"]),t[25]||(t[25]=(0,l.Lk)("h3",{class:"flex-grow-1"},"Action Requests",-1)),(0,l.bF)(G,{onClick:e.openExportModal,icon:"download",color:"primary",preset:"secondary"},{default:(0,l.k6)(()=>t[24]||(t[24]=[(0,l.eW)(" Export Excel ")])),_:1,__:[24]},8,["onClick"])]),(0,l.Lk)("div",w,[(0,l.bF)(ee,{modelValue:e.filters.search,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filters.search=t),label:"Search Requests",placeholder:"Search by title, details, sender, or department...","prepend-icon":"search",clearable:"",class:"search-input mb-3"},null,8,["modelValue"]),(0,l.Lk)("div",v,[(0,l.Lk)("div",b,[(0,l.bF)(te,{modelValue:e.filters.status,"onUpdate:modelValue":t[1]||(t[1]=t=>e.filters.status=t),options:["All","Open","In-Progress","Closed"],label:"Status",class:"mr-3 filter-select"},null,8,["modelValue"]),(0,l.bF)(te,{modelValue:e.filters.senderDepartment,"onUpdate:modelValue":t[2]||(t[2]=t=>e.filters.senderDepartment=t),options:e.senderDepartmentOptions,label:"Sent From",class:"mr-3 filter-select"},null,8,["modelValue","options"]),(0,l.bF)(te,{modelValue:e.filters.receiverDepartment,"onUpdate:modelValue":t[3]||(t[3]=t=>e.filters.receiverDepartment=t),options:e.receiverDepartmentOptions,label:"Sent To",class:"filter-select"},null,8,["modelValue","options"])]),(0,l.bF)(re,{modelValue:e.showAdvancedFilters,"onUpdate:modelValue":t[7]||(t[7]=t=>e.showAdvancedFilters=t)},{header:(0,l.k6)(()=>[(0,l.bF)(G,{onClick:t[4]||(t[4]=t=>e.showAdvancedFilters=!e.showAdvancedFilters),preset:"plain",icon:"tune",size:"small"},{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)(e.showAdvancedFilters?"Hide":"Show")+" Advanced Filters ",1)]),_:1})]),default:(0,l.k6)(()=>[(0,l.Lk)("div",k,[(0,l.bF)(se,{modelValue:e.filters.dateFrom,"onUpdate:modelValue":t[5]||(t[5]=t=>e.filters.dateFrom=t),label:"From Date",class:"mr-3 filter-select",clearable:""},null,8,["modelValue"]),(0,l.bF)(se,{modelValue:e.filters.dateTo,"onUpdate:modelValue":t[6]||(t[6]=t=>e.filters.dateTo=t),label:"To Date",class:"filter-select",clearable:""},null,8,["modelValue"])])]),_:1},8,["modelValue"])])]),(0,l.bF)(le,{requests:e.filteredRequests,"can-comment":e.canComment,"can-delete":e.canDelete,"can-delete-all":e.canDeleteAll,"is-view-only":e.isViewOnly,"current-user-id":e.currentUserProfile?.uid,onComment:e.handleComment,onViewRequest:e.showRequestDetails,onDeleteRequest:e.confirmDeleteRequestFromList},null,8,["requests","can-comment","can-delete","can-delete-all","is-view-only","current-user-id","onComment","onViewRequest","onDeleteRequest"])])):(0,l.Q3)("",!0),"add-request"===e.currentView?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("div",_,[(0,l.bF)(G,{onClick:e.goHome,icon:"arrow_back",preset:"plain",class:"mr-3"},{default:(0,l.k6)(()=>t[26]||(t[26]=[(0,l.eW)(" Back to Home ")])),_:1,__:[26]},8,["onClick"]),t[27]||(t[27]=(0,l.Lk)("h3",null,"Add New Request",-1))]),(0,l.bF)(ae,{onSubmit:e.handleNewRequest},null,8,["onSubmit"])])):(0,l.Q3)("",!0),(0,l.bF)(de,{modelValue:e.showModal,"onUpdate:modelValue":t[8]||(t[8]=t=>e.showModal=t),title:"Request Details",size:"large"},{default:(0,l.k6)(()=>[e.selectedRequest?((0,l.uX)(),(0,l.CE)("div",E,[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[(0,l.bF)(oe,null,{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)(e.selectedRequest.title),1)]),_:1}),(0,l.bF)(Y,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",D,[t[28]||(t[28]=(0,l.Lk)("strong",null,"Status:",-1)),(0,l.bF)(ie,{color:e.getStatusColor(e.selectedRequest.status),text:e.selectedRequest.status,class:"ml-2"},null,8,["color","text"])]),(0,l.Lk)("div",C,[t[29]||(t[29]=(0,l.Lk)("strong",null,"Sender:",-1)),(0,l.eW)(" "+(0,o.v_)(e.selectedRequest.senderName),1)]),(0,l.Lk)("div",U,[t[30]||(t[30]=(0,l.Lk)("strong",null,"Sender Department:",-1)),(0,l.eW)(" "+(0,o.v_)(e.selectedRequest.senderDepartment),1)]),(0,l.Lk)("div",q,[t[31]||(t[31]=(0,l.Lk)("strong",null,"Receiver Department:",-1)),(0,l.eW)(" "+(0,o.v_)(e.selectedRequest.receiverDepartment),1)]),(0,l.Lk)("div",V,[t[32]||(t[32]=(0,l.Lk)("strong",null,"Created:",-1)),(0,l.eW)(" "+(0,o.v_)(e.formatDate(e.selectedRequest.createdAt)),1)]),(0,l.Lk)("div",L,[t[33]||(t[33]=(0,l.Lk)("strong",null,"Description:",-1)),(0,l.Lk)("p",null,(0,o.v_)(e.selectedRequest.details),1)]),e.isViewOnly?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",A,[e.canDelete||e.canDeleteAll||e.selectedRequest.senderId===e.currentUserProfile?.uid?((0,l.uX)(),(0,l.Wv)(G,{key:0,onClick:e.confirmDeleteRequest,color:"danger",icon:"delete",size:"small"},{default:(0,l.k6)(()=>t[34]||(t[34]=[(0,l.eW)(" Delete Request ")])),_:1,__:[34]},8,["onClick"])):(0,l.Q3)("",!0)])),(0,l.Lk)("div",F,[t[37]||(t[37]=(0,l.Lk)("h4",null,"Comments",-1)),e.selectedRequestComments.length>0?((0,l.uX)(),(0,l.CE)("div",S,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.selectedRequestComments,t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id,class:"comment mb-3"},[(0,l.bF)(Z,null,{default:(0,l.k6)(()=>[(0,l.bF)(Y,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",R,[(0,l.Lk)("div",null,[(0,l.Lk)("strong",null,(0,o.v_)(t.authorName),1),(0,l.Lk)("span",x,(0,o.v_)(e.formatDate(t.createdAt)),1)]),e.isViewOnly||!e.canDelete&&!e.canDeleteAll&&t.authorId!==e.currentUserProfile?.uid?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(G,{key:0,onClick:s=>e.confirmDeleteComment(t.id),color:"danger",icon:"delete",size:"small",preset:"plain"},null,8,["onClick"]))]),(0,l.Lk)("p",null,(0,o.v_)(t.text),1)]),_:2},1024)]),_:2},1024)]))),128))])):((0,l.uX)(),(0,l.CE)("div",P,t[35]||(t[35]=[(0,l.Lk)("p",{class:"text-muted"},"No comments yet.",-1)]))),e.canComment?((0,l.uX)(),(0,l.Wv)(ne,{key:2,onSubmit:e.handleModalComment},null,8,["onSubmit"])):e.isViewOnly?((0,l.uX)(),(0,l.CE)("div",N,t[36]||(t[36]=[(0,l.Lk)("p",null,[(0,l.Lk)("em",null,"You have view-only access and cannot add comments.")],-1)]))):(0,l.Q3)("",!0)])]),_:1})]),_:1})])):(0,l.Q3)("",!0)]),_:1},8,["modelValue"]),(0,l.bF)(de,{modelValue:e.showDeleteRequestDialog,"onUpdate:modelValue":t[10]||(t[10]=t=>e.showDeleteRequestDialog=t),title:"Confirm Delete",size:"small",hideDefaultActions:!0},{default:(0,l.k6)(()=>[(0,l.Lk)("div",I,[t[40]||(t[40]=(0,l.Lk)("p",null," Are you sure you want to delete this request? This action cannot be undone. ",-1)),(0,l.Lk)("div",T,[(0,l.bF)(G,{onClick:t[9]||(t[9]=t=>e.showDeleteRequestDialog=!1),color:"secondary",class:"mr-2"},{default:(0,l.k6)(()=>t[38]||(t[38]=[(0,l.eW)(" Cancel ")])),_:1,__:[38]}),(0,l.bF)(G,{onClick:e.deleteRequest,color:"danger",loading:e.deletingRequest},{default:(0,l.k6)(()=>t[39]||(t[39]=[(0,l.eW)(" Delete ")])),_:1,__:[39]},8,["onClick","loading"])])])]),_:1},8,["modelValue"]),(0,l.bF)(de,{modelValue:e.showDeleteCommentDialog,"onUpdate:modelValue":t[12]||(t[12]=t=>e.showDeleteCommentDialog=t),title:"Confirm Delete",size:"small",hideDefaultActions:!0},{default:(0,l.k6)(()=>[(0,l.Lk)("div",M,[t[43]||(t[43]=(0,l.Lk)("p",null," Are you sure you want to delete this comment? This action cannot be undone. ",-1)),(0,l.Lk)("div",W,[(0,l.bF)(G,{onClick:t[11]||(t[11]=t=>e.showDeleteCommentDialog=!1),color:"secondary",class:"mr-2"},{default:(0,l.k6)(()=>t[41]||(t[41]=[(0,l.eW)(" Cancel ")])),_:1,__:[41]}),(0,l.bF)(G,{onClick:e.deleteComment,color:"danger",loading:e.deletingComment},{default:(0,l.k6)(()=>t[42]||(t[42]=[(0,l.eW)(" Delete ")])),_:1,__:[42]},8,["onClick","loading"])])])]),_:1},8,["modelValue"]),(0,l.bF)(de,{modelValue:e.showExportModal,"onUpdate:modelValue":t[16]||(t[16]=t=>e.showExportModal=t),title:"Export Requests to Excel",size:"medium","max-width":"600px"},{footer:(0,l.k6)(()=>[(0,l.bF)(G,{onClick:t[15]||(t[15]=t=>e.showExportModal=!1),preset:"secondary",class:"mr-3"},{default:(0,l.k6)(()=>t[45]||(t[45]=[(0,l.eW)(" Cancel ")])),_:1,__:[45]}),(0,l.bF)(G,{onClick:e.exportToExcel,color:"primary",loading:e.exportLoading,disabled:!e.hasSelectedFields},{default:(0,l.k6)(()=>t[46]||(t[46]=[(0,l.eW)(" Export Excel ")])),_:1,__:[46]},8,["onClick","loading","disabled"])]),default:(0,l.k6)(()=>[(0,l.Lk)("div",O,[t[44]||(t[44]=(0,l.Lk)("p",{class:"mb-4"}," Select the fields you want to include in the Excel export: ",-1)),(0,l.Lk)("div",B,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.exportFields,e=>((0,l.uX)(),(0,l.Wv)(ue,{key:e.key,modelValue:e.selected,"onUpdate:modelValue":t=>e.selected=t,label:e.label,class:"mb-2"},null,8,["modelValue","onUpdate:modelValue","label"]))),128))]),(0,l.Lk)("div",X,[(0,l.bF)(ue,{modelValue:e.includeComments,"onUpdate:modelValue":t[13]||(t[13]=t=>e.includeComments=t),label:"Include Comments",class:"mb-2"},null,8,["modelValue"]),(0,l.bF)(ue,{modelValue:e.applyCurrentFilters,"onUpdate:modelValue":t[14]||(t[14]=t=>e.applyCurrentFilters=t),label:"Apply Current Filters",class:"mb-2"},null,8,["modelValue"])])])]),_:1},8,["modelValue"])]),_:1}),(0,l.bF)(me,{"is-visible":e.showProfileModal,"user-profile":e.currentUserProfile,onSaved:e.handleProfileSave,onClose:t[17]||(t[17]=t=>e.showProfileModal=!1)},null,8,["is-visible","user-profile","onSaved"]),(0,l.bF)(he,{modelValue:e.showUserManagementModal,"onUpdate:modelValue":t[18]||(t[18]=t=>e.showUserManagementModal=t)},null,8,["modelValue"])])):((0,l.uX)(),(0,l.Wv)(H,{key:1,onLoginSuccess:e.handleLoginSuccess,"session-expired":e.sessionExpired},null,8,["onLoginSuccess","session-expired"]))}const z={class:"requests-grid"};function H(e,t,s,r,a,o){const i=(0,l.g2)("request-card");return(0,l.uX)(),(0,l.CE)("div",z,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.requests,t=>((0,l.uX)(),(0,l.Wv)(i,{key:t.id,request:t,"can-comment":e.canComment,"can-delete":e.canDelete,"can-delete-all":e.canDeleteAll,"is-view-only":e.isViewOnly,"current-user-id":e.currentUserId,onComment:e.emitComment,onViewRequest:e.viewRequest,onDeleteRequest:e.deleteRequest},null,8,["request","can-comment","can-delete","can-delete-all","is-view-only","current-user-id","onComment","onViewRequest","onDeleteRequest"]))),128))])}const j={class:"card-header"},K={class:"request-title"},Q={class:"request-meta"},G={class:"meta-item"},J={class:"meta-item"},Y={class:"meta-item"},Z={class:"meta-item"},ee={class:"request-details"},te={key:0},se={class:"comments-section"},re={key:0,class:"loading-comments"},le={key:1,class:"comments-list"},ae={class:"comment-content"},oe={class:"comment-date"},ie={key:2,class:"no-comments"},ne={key:3,class:"add-comment-section"},de={key:4,class:"view-only-message"};function ue(e,t,s,a,i,n){const d=(0,l.g2)("va-badge"),u=(0,l.g2)("va-icon"),c=(0,l.g2)("va-button"),m=(0,l.g2)("va-progress-circle"),h=(0,l.g2)("add-comment"),p=(0,l.g2)("va-collapse"),f=(0,l.g2)("va-card-content"),g=(0,l.g2)("va-card");return(0,l.uX)(),(0,l.Wv)(g,{class:"request-card clickable-card",onClick:e.handleCardClick},{default:(0,l.k6)(()=>[(0,l.bF)(f,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",j,[(0,l.Lk)("h3",K,(0,o.v_)(e.request.title),1),(0,l.bF)(d,{text:e.request.status,color:e.statusColor,class:"status-badge"},null,8,["text","color"])]),(0,l.Lk)("div",Q,[(0,l.Lk)("div",G,[(0,l.bF)(u,{name:"person",size:"small"}),(0,l.Lk)("span",null,[t[2]||(t[2]=(0,l.Lk)("strong",null,"Sender:",-1)),(0,l.eW)(" "+(0,o.v_)(e.request.senderName),1)])]),(0,l.Lk)("div",J,[(0,l.bF)(u,{name:"business",size:"small"}),(0,l.Lk)("span",null,[t[3]||(t[3]=(0,l.Lk)("strong",null,"From:",-1)),(0,l.eW)(" "+(0,o.v_)(e.request.senderDepartment),1)])]),(0,l.Lk)("div",Y,[(0,l.bF)(u,{name:"business",size:"small"}),(0,l.Lk)("span",null,[t[4]||(t[4]=(0,l.Lk)("strong",null,"To:",-1)),(0,l.eW)(" "+(0,o.v_)(e.request.receiverDepartment),1)])]),(0,l.Lk)("div",Z,[(0,l.bF)(u,{name:"schedule",size:"small"}),(0,l.Lk)("span",null,[t[5]||(t[5]=(0,l.Lk)("strong",null,"Created:",-1)),(0,l.eW)(" "+(0,o.v_)(e.formattedDate),1)])])]),(0,l.Lk)("div",ee,[(0,l.Lk)("p",null,(0,o.v_)(e.request.details),1)]),(0,l.Lk)("div",{class:"card-actions",onClick:t[0]||(t[0]=(0,r.D$)(()=>{},["stop"]))},[(0,l.bF)(c,{onClick:e.viewDetails,color:"primary",size:"small",icon:"visibility"},{default:(0,l.k6)(()=>t[6]||(t[6]=[(0,l.eW)(" View Details ")])),_:1,__:[6]},8,["onClick"]),e.isViewOnly?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(c,{key:0,onClick:e.toggleComments,outline:"",size:"small",icon:e.showComments?"expand_less":"expand_more"},{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)(e.showComments?"Hide":"Show")+" Comments ",1),e.comments.length>0?((0,l.uX)(),(0,l.CE)("span",te,"("+(0,o.v_)(e.comments.length)+")",1)):(0,l.Q3)("",!0)]),_:1},8,["onClick","icon"])),e.canDeleteThis?((0,l.uX)(),(0,l.Wv)(c,{key:1,onClick:e.deleteRequest,color:"danger",size:"small",icon:"delete",outline:""},{default:(0,l.k6)(()=>t[7]||(t[7]=[(0,l.eW)(" Delete ")])),_:1,__:[7]},8,["onClick"])):(0,l.Q3)("",!0)]),(0,l.bF)(p,{modelValue:e.showComments,"onUpdate:modelValue":t[1]||(t[1]=t=>e.showComments=t)},{default:(0,l.k6)(()=>[(0,l.Lk)("div",se,[t[11]||(t[11]=(0,l.Lk)("h4",null,"Comments",-1)),e.loadingComments?((0,l.uX)(),(0,l.CE)("div",re,[(0,l.bF)(m,{indeterminate:"",size:"small"}),t[8]||(t[8]=(0,l.Lk)("span",null,"Loading comments...",-1))])):e.comments.length>0?((0,l.uX)(),(0,l.CE)("div",le,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.comments,e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"comment-item"},[(0,l.Lk)("div",ae,[(0,l.Lk)("p",null,(0,o.v_)(e.text),1),(0,l.Lk)("small",oe,(0,o.v_)(new Date(e.createdAt).toLocaleString()),1)])]))),128))])):((0,l.uX)(),(0,l.CE)("div",ie,t[9]||(t[9]=[(0,l.Lk)("p",null,"No comments yet. Be the first to add one!",-1)]))),e.canCommentThis?((0,l.uX)(),(0,l.CE)("div",ne,[(0,l.bF)(h,{onSubmit:e.onComment},null,8,["onSubmit"])])):e.isViewOnly?((0,l.uX)(),(0,l.CE)("div",de,t[10]||(t[10]=[(0,l.Lk)("p",{class:"text-muted"},[(0,l.Lk)("em",null,"You have view-only access and cannot add comments.")],-1)]))):(0,l.Q3)("",!0)])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["onClick"])}const ce={class:"add-comment"},me={class:"comment-form"},he={class:"form-actions"},pe={class:"char-count"};function fe(e,t,s,r,a,i){const n=(0,l.g2)("va-textarea"),d=(0,l.g2)("va-button");return(0,l.uX)(),(0,l.CE)("div",ce,[(0,l.Lk)("div",me,[(0,l.bF)(n,{modelValue:e.text,"onUpdate:modelValue":t[0]||(t[0]=t=>e.text=t),placeholder:"Add a comment... (Ctrl+Enter to submit)",rows:3,disabled:e.isSubmitting,onKeydown:e.handleKeydown,class:"comment-textarea"},null,8,["modelValue","disabled","onKeydown"]),(0,l.Lk)("div",he,[(0,l.Lk)("div",pe,(0,o.v_)(e.text.length)+"/500 ",1),(0,l.bF)(d,{onClick:e.submit,disabled:!e.isValid||e.isSubmitting,loading:e.isSubmitting,color:"primary",size:"small"},{default:(0,l.k6)(()=>t[1]||(t[1]=[(0,l.eW)(" Submit Comment ")])),_:1,__:[1]},8,["onClick","disabled","loading"])])])])}const ge=(0,l.pM)({name:"AddComment",data(){return{text:"",isSubmitting:!1}},computed:{isValid(){return this.text.trim().length>0}},methods:{async submit(){if(this.isValid&&!this.isSubmitting){this.isSubmitting=!0;try{this.$emit("submit",this.text.trim()),this.text=""}finally{this.isSubmitting=!1}}},handleKeydown(e){"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),this.submit())}}});var we=s(262);const ve=(0,we.A)(ge,[["render",fe]]),be=ve;var ke=s(223),ye=s(884),_e=s(415);const Ee={apiKey:{NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_FIREBASE_API_KEY||"",authDomain:{NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_FIREBASE_AUTH_DOMAIN||"",projectId:{NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_FIREBASE_PROJECT_ID||"",storageBucket:{NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_FIREBASE_STORAGE_BUCKET||"",messagingSenderId:{NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_FIREBASE_MESSAGING_SENDER_ID||"",appId:{NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_FIREBASE_APP_ID||"",measurementId:{NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_FIREBASE_MEASUREMENT_ID||""},De=["VUE_APP_FIREBASE_API_KEY","VUE_APP_FIREBASE_AUTH_DOMAIN","VUE_APP_FIREBASE_PROJECT_ID","VUE_APP_FIREBASE_STORAGE_BUCKET","VUE_APP_FIREBASE_MESSAGING_SENDER_ID","VUE_APP_FIREBASE_APP_ID"],Ce=De.filter(e=>!{NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}[e]);if(Ce.length>0)throw new Error(`Missing required environment variables: ${Ce.join(", ")}. Please check your .env file and ensure all Firebase configuration variables are set.`);const Ue=(0,ke.Wp)(Ee),qe=(0,ye.aU)(Ue),Ve=(0,_e.xI)(Ue);async function Le(e,t){try{const s=await(0,_e.x9)(Ve,e,t);return s.user}catch(s){throw console.error("Error signing in:",s),s}}async function Ae(){try{await(0,_e.CI)(Ve)}catch(e){throw console.error("Error signing out:",e),e}}function Fe(e){return(0,_e.hg)(Ve,e)}function Se(){return Ve.currentUser}const Re={NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_SUPERADMIN_EMAIL;function xe(e){return Re?e===Re:(console.warn("VUE_APP_SUPERADMIN_EMAIL environment variable is not set"),!1)}function Pe(e,t,s){if(xe(s))return!0;const r={viewer:["view"],user:["view","create","comment","edit_own","delete_own"],admin:["view","create","comment","edit_own","delete_own","edit_all","delete_all","manage_users"]};return r[e]?.includes(t)||!1}function Ne(e,t){return!xe(t)&&"viewer"===e}function Ie(e,t){return!!xe(t)||"admin"===e}async function Te(){const e=Se();if(!e)throw new Error("User must be authenticated to access users");const t=await Be(e.uid);if(!t||!Ie(t.role,t.email))throw new Error("Insufficient permissions to access users");try{const e=(0,ye.rJ)(qe,"users"),t=await(0,ye.GG)(e);return t.docs.map(e=>({uid:e.id,...e.data()}))}catch(s){throw console.error("Error fetching users:",s),s}}async function Me(e,t,s){const r=Se();if(!r)throw new Error("User must be authenticated to create users");const l=await Be(r.uid);if(!l||!Ie(l.role,l.email))throw new Error("Insufficient permissions to create users");try{const r=await(0,_e.eJ)(Ve,e,t),l=r.user;await Xe({uid:l.uid,email:l.email||e,...s})}catch(a){throw console.error("Error creating user:",a),a}}async function We(e,t){const s=Se();if(!s)throw new Error("User must be authenticated to update user roles");const r=await Be(s.uid);if(!r||!Ie(r.role,r.email))throw new Error("Insufficient permissions to update user roles");try{await $e(e,{role:t})}catch(l){throw console.error("Error updating user role:",l),l}}async function Oe(e){const t=Se();if(!t)throw new Error("User must be authenticated to delete users");const s=await Be(t.uid);if(!s||!Ie(s.role,s.email))throw new Error("Insufficient permissions to delete users");try{const t=(0,ye.H9)(qe,"users",e);await(0,ye.kd)(t)}catch(r){throw console.error("Error deleting user:",r),r}}async function Be(e){try{const t=(0,ye.H9)(qe,"users",e),s=await(0,ye.x7)(t);return s.exists()?{uid:e,...s.data()}:null}catch(t){throw console.error("Error getting user profile:",t),t}}async function Xe(e){try{const t=(0,ye.H9)(qe,"users",e.uid);await(0,ye.BN)(t,{...e,role:e.role||"user",createdAt:Date.now(),updatedAt:Date.now()})}catch(t){throw console.error("Error creating user profile:",t),t}}async function $e(e,t){try{const s=(0,ye.H9)(qe,"users",e);await(0,ye.mZ)(s,{...t,updatedAt:Date.now()})}catch(s){throw console.error("Error updating user profile:",s),s}}const ze=(0,ye.rJ)(qe,"requests");async function He(e){const t=Se();if(!t)throw new Error("User must be authenticated to access requests");try{let t=(0,ye.P)(ze,(0,ye.My)("createdAt","desc"));const s=await(0,ye.GG)(t);let r=s.docs.map(e=>({id:e.id,...e.data()}));if(e&&(e.status&&(r=r.filter(t=>t.status===e.status)),e.department&&(r=r.filter(t=>t.receiverDepartment===e.department)),e.search)){const t=e.search.toLowerCase();r=r.filter(e=>e.title.toLowerCase().includes(t)||e.details.toLowerCase().includes(t))}return r}catch(s){throw console.error("Error fetching requests:",s),s}}async function je(e){const t=Se();if(!t)throw new Error("User must be authenticated to create requests");const s=await Be(t.uid);if(!s)throw new Error("User profile not found");if(!Pe(s.role,"create",s.email))throw new Error("Insufficient permissions to create requests");const r={...e,senderId:t.uid,senderName:`${s.firstName} ${s.lastName}`,senderDepartment:s.department,createdAt:Date.now()},l=await(0,ye.gS)(ze,r);return l.id}async function Ke(e){const t=(0,ye.rJ)((0,ye.H9)(qe,"requests",e),"comments"),s=await(0,ye.GG)(t);return s.docs.map(e=>({id:e.id,...e.data()}))}async function Qe(e){try{const t=(0,ye.H9)(qe,"requests",e),s=await(0,ye.x7)(t);if(!s.exists())return null;const r={id:s.id,...s.data()},l=await Ke(e);return r.comments=l,r}catch(t){throw console.error("Error fetching request by ID:",t),t}}async function Ge(e){const t=Se();if(!t)throw new Error("User must be authenticated to delete requests");const s=await Be(t.uid);if(!s)throw new Error("User profile not found");if(!Pe(s.role,"delete_all",s.email)){const r=await Qe(e);if(!r||r.senderId!==t.uid)throw new Error("Insufficient permissions to delete this request");if(!Pe(s.role,"delete_own",s.email))throw new Error("Insufficient permissions to delete requests")}try{const t=(0,ye.H9)(qe,"requests",e);await(0,ye.kd)(t)}catch(r){throw console.error("Error deleting request:",r),r}}async function Je(e,t){const s=Se();if(!s)throw new Error("User must be authenticated to add comments");const r=await Be(s.uid);if(!r)throw new Error("User profile not found");if(!Pe(r.role,"comment",r.email))throw new Error("Insufficient permissions to add comments");const l=(0,ye.rJ)((0,ye.H9)(qe,"requests",e),"comments"),a=await(0,ye.gS)(l,{text:t,authorId:s.uid,authorName:`${r.firstName} ${r.lastName}`,createdAt:Date.now()});return a.id}async function Ye(e,t){const s=Se();if(!s)throw new Error("User must be authenticated to delete comments");const r=await Be(s.uid);if(!r)throw new Error("User profile not found");if(!Pe(r.role,"delete_all",r.email)){const l=(0,ye.H9)(qe,"requests",e,"comments",t),a=await(0,ye.x7)(l);if(!a.exists())throw new Error("Comment not found");const o=a.data();if(o.authorId!==s.uid)throw new Error("Insufficient permissions to delete this comment");if(!Pe(r.role,"delete_own",r.email))throw new Error("Insufficient permissions to delete comments")}try{const s=(0,ye.H9)(qe,"requests",e,"comments",t);await(0,ye.kd)(s)}catch(l){throw console.error("Error deleting comment:",l),l}}const Ze=(0,l.pM)({name:"RequestCard",components:{AddComment:be},emits:["comment","view-request","delete-request"],props:{request:{type:Object,required:!0},canComment:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canDeleteAll:{type:Boolean,default:!1},isViewOnly:{type:Boolean,default:!1},currentUserId:{type:String,default:""}},data(){return{comments:[],showComments:!1,loadingComments:!1}},computed:{statusColor(){switch(this.request.status){case"Open":return"warning";case"In-Progress":return"primary";case"Closed":return"success";default:return"secondary"}},formattedDate(){return new Date(this.request.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},canDeleteThis(){return this.canDeleteAll||this.canDelete&&this.request.senderId===this.currentUserId},canCommentThis(){return this.canComment&&!this.isViewOnly}},methods:{handleCardClick(){this.viewDetails()},viewDetails(){this.$emit("view-request",this.request)},deleteRequest(){this.$emit("delete-request",this.request)},async onComment(e){this.request.id&&(this.$emit("comment",{id:this.request.id,text:e}),this.showComments&&await this.loadComments())},async toggleComments(){this.showComments=!this.showComments,this.showComments&&0===this.comments.length&&await this.loadComments()},async loadComments(){if(this.request.id){this.loadingComments=!0;try{this.comments=await Ke(this.request.id)}catch(e){console.error("Error loading comments:",e)}finally{this.loadingComments=!1}}}}}),et=(0,we.A)(Ze,[["render",ue]]),tt=et,st=(0,l.pM)({name:"RequestList",components:{RequestCard:tt},props:{requests:{type:Array,required:!0},canComment:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},canDeleteAll:{type:Boolean,default:!1},isViewOnly:{type:Boolean,default:!1},currentUserId:{type:String,default:""}},emits:["comment","view-request","delete-request"],methods:{emitComment(e){this.$emit("comment",e)},viewRequest(e){this.$emit("view-request",e)},deleteRequest(e){this.$emit("delete-request",e)}}}),rt=(0,we.A)(st,[["render",H]]),lt=rt,at={class:"mb-1"},ot={class:"mb-1"},it={class:"mb-1"},nt={class:"form-actions"};function dt(e,t,s,a,i,n){const d=(0,l.g2)("va-card-title"),u=(0,l.g2)("va-card-content"),c=(0,l.g2)("va-card"),m=(0,l.g2)("va-input"),h=(0,l.g2)("va-select"),p=(0,l.g2)("va-textarea"),f=(0,l.g2)("va-button");return(0,l.uX)(),(0,l.Wv)(c,{class:"request-form-card"},{default:(0,l.k6)(()=>[(0,l.bF)(d,null,{default:(0,l.k6)(()=>t[5]||(t[5]=[(0,l.eW)("Create New Request")])),_:1,__:[5]}),(0,l.bF)(u,null,{default:(0,l.k6)(()=>[(0,l.bF)(c,{class:"sender-preview-card mb-4",color:"info",stripe:""},{default:(0,l.k6)(()=>[(0,l.bF)(u,null,{default:(0,l.k6)(()=>[t[9]||(t[9]=(0,l.Lk)("h4",{class:"mb-2"},"Request Preview",-1)),(0,l.Lk)("p",at,[t[6]||(t[6]=(0,l.Lk)("strong",null,"Sender:",-1)),(0,l.eW)(" "+(0,o.v_)(e.currentUserProfile?.firstName)+" "+(0,o.v_)(e.currentUserProfile?.lastName),1)]),(0,l.Lk)("p",ot,[t[7]||(t[7]=(0,l.Lk)("strong",null,"From Department:",-1)),(0,l.eW)(" "+(0,o.v_)(e.currentUserProfile?.department),1)]),(0,l.Lk)("p",it,[t[8]||(t[8]=(0,l.Lk)("strong",null,"To Department:",-1)),(0,l.eW)(" "+(0,o.v_)(e.form.receiverDepartment||"Not selected"),1)])]),_:1,__:[9]})]),_:1}),(0,l.Lk)("form",{onSubmit:t[4]||(t[4]=(0,r.D$)((...t)=>e.onSubmit&&e.onSubmit(...t),["prevent"])),class:"request-form"},[(0,l.bF)(m,{modelValue:e.form.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.title=t),label:"Request Title",placeholder:"Enter a descriptive title for your request",rules:[e=>!!e||"Title is required"],required:"",class:"full-width mb-4"},null,8,["modelValue","rules"]),(0,l.bF)(h,{modelValue:e.form.receiverDepartment,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.receiverDepartment=t),label:"Request To Department",options:e.departments,placeholder:"Select which department should handle this request",rules:[e=>!!e||"Receiver department is required"],required:"",class:"full-width mb-4"},null,8,["modelValue","options","rules"]),(0,l.bF)(p,{modelValue:e.form.details,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.details=t),label:"Request Details",placeholder:"Provide detailed information about your request...",rows:4,class:"full-width"},null,8,["modelValue"]),(0,l.bF)(h,{modelValue:e.form.status,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.status=t),label:"Initial Status",options:e.statuses,rules:[e=>!!e||"Status is required"],required:"",class:"status-select"},null,8,["modelValue","options","rules"]),(0,l.Lk)("div",nt,[(0,l.bF)(f,{type:"button",onClick:e.resetForm,outline:"",disabled:e.isSubmitting},{default:(0,l.k6)(()=>t[10]||(t[10]=[(0,l.eW)(" Reset Form ")])),_:1,__:[10]},8,["onClick","disabled"]),(0,l.bF)(f,{type:"submit",color:"primary",disabled:!e.isValid||e.isSubmitting,loading:e.isSubmitting},{default:(0,l.k6)(()=>t[11]||(t[11]=[(0,l.eW)(" Create Request ")])),_:1,__:[11]},8,["disabled","loading"])])],32)]),_:1})]),_:1})}const ut=["Asset Department","Projects Department","Business Development Department","Finance Department","Leasing Department","COO Office","Facilities Management Department","Accounting Department","IT Department","Property and Asset Management Department","HR Department","Accounts Department","Procurement Department","Contracts Department","Marketing Department","Strategic Department","Legal Department"],ct=["All",...ut],mt=["All Sender Departments",...ut],ht=["All Receiver Departments",...ut];var pt=s(953);const ft=(0,pt.Kh)({isAuthenticated:!1,user:null,loading:!1,error:null,sessionExpired:!1}),gt="action_tracker_user_session",wt=24*parseInt({NODE_ENV:"production",BASE_URL:"/action-list-tracker/"}.VUE_APP_SESSION_DURATION_DAYS||"7",10)*60*60*1e3;class vt{get canCreateRequests(){return!!ft.user&&Pe(ft.user.role,"create",ft.user.email)}get canComment(){return!!ft.user&&Pe(ft.user.role,"comment",ft.user.email)}get canDelete(){return!!ft.user&&Pe(ft.user.role,"delete_own",ft.user.email)}get canDeleteAll(){return!!ft.user&&Pe(ft.user.role,"delete_all",ft.user.email)}get canManageUsers(){return!!ft.user&&Ie(ft.user.role,ft.user.email)}get isViewOnly(){return!!ft.user&&Ne(ft.user.role,ft.user.email)}get isSuperAdmin(){return!!ft.user&&xe(ft.user.email)}get isAuthenticated(){return ft.isAuthenticated}get user(){return ft.user}get loading(){return ft.loading}get error(){return ft.error}get sessionExpired(){return ft.sessionExpired}async initialize(){ft.loading=!0,ft.error=null;try{const e=this.getStoredSession();e&&this.isSessionValid(e)?ft.loading=!0:this.clearStoredSession(),Fe(async e=>{try{e?await this.handleAuthenticatedUser(e.uid,e.email||""):await this.handleUnauthenticatedUser()}catch(t){console.error("Error in auth state change:",t),ft.error="Authentication error occurred"}finally{ft.loading=!1}})}catch(e){console.error("Error initializing user store:",e),ft.error="Failed to initialize authentication",ft.loading=!1}}async handleAuthenticatedUser(e,t){try{const s=await Be(e);s?(ft.user=s,ft.isAuthenticated=!0,ft.sessionExpired=!1,this.storeUserSession({uid:e,email:t,lastLoginTime:Date.now(),rememberMe:!0})):(ft.user=null,ft.isAuthenticated=!0,ft.sessionExpired=!1)}catch(s){console.error("Error loading user profile:",s),ft.error="Failed to load user profile",await this.logout()}}async handleUnauthenticatedUser(){const e=this.getStoredSession();e&&this.isSessionValid(e)&&(ft.sessionExpired=!0,ft.error="Your session has expired. Please log in again."),ft.user=null,ft.isAuthenticated=!1,this.clearStoredSession()}async saveUserProfile(e){const t=Se();if(!t)throw new Error("User must be authenticated to save profile");ft.loading=!0,ft.error=null;try{if(ft.user)await $e(t.uid,e);else{const s={uid:t.uid,email:t.email||"",firstName:e.firstName||"",lastName:e.lastName||"",department:e.department||"",title:e.title||"",role:e.role||"user"};await Xe(s)}const s=await Be(t.uid);s&&(ft.user=s)}catch(s){throw console.error("Error saving user profile:",s),ft.error="Failed to save user profile",s}finally{ft.loading=!1}}async logout(){try{await Ae()}catch(e){console.error("Error during logout:",e)}finally{ft.user=null,ft.isAuthenticated=!1,ft.sessionExpired=!1,ft.error=null,this.clearStoredSession()}}clearError(){ft.error=null,ft.sessionExpired=!1}hasPermission(e){return!!ft.user&&Pe(ft.user.role,e,ft.user.email)}hasRole(e){return!!ft.user&&ft.user.role===e}storeUserSession(e){try{localStorage.setItem(gt,JSON.stringify(e))}catch(t){console.warn("Failed to store user session:",t)}}getStoredSession(){try{const e=localStorage.getItem(gt);return e?JSON.parse(e):null}catch(e){return console.warn("Failed to get stored session:",e),null}}clearStoredSession(){try{localStorage.removeItem(gt)}catch(e){console.warn("Failed to clear stored session:",e)}}isSessionValid(e){const t=Date.now(),s=t-e.lastLoginTime;return s<wt}}const bt=new vt,kt=(0,l.pM)({name:"RequestForm",data(){return{form:{title:"",details:"",status:"Open",receiverDepartment:""},statuses:["Open","In-Progress","Closed"],departments:ut,isSubmitting:!1}},computed:{currentUserProfile(){return bt.user},isValid(){return this.form.title.trim()&&this.form.status&&this.form.receiverDepartment}},methods:{async onSubmit(){if(this.isValid&&!this.isSubmitting){this.isSubmitting=!0;try{this.$emit("submit",{...this.form})}finally{this.isSubmitting=!1}}},resetForm(){this.form={title:"",details:"",status:"Open",receiverDepartment:""}}}}),yt=(0,we.A)(kt,[["render",dt]]),_t=yt,Et={class:"login-container"};function Dt(e,t,s,a,o,i){const n=(0,l.g2)("va-card-title"),d=(0,l.g2)("va-alert"),u=(0,l.g2)("va-input"),c=(0,l.g2)("va-button"),m=(0,l.g2)("va-card-content"),h=(0,l.g2)("va-card");return(0,l.uX)(),(0,l.CE)("div",Et,[(0,l.bF)(h,{class:"login-card"},{default:(0,l.k6)(()=>[(0,l.bF)(n,{class:"text-center"},{default:(0,l.k6)(()=>t[3]||(t[3]=[(0,l.Lk)("h2",null,"AZAD Properties : BAS - Project Integration",-1),(0,l.Lk)("p",{class:"subtitle"},"Sign in to your account",-1)])),_:1,__:[3]}),(0,l.bF)(m,null,{default:(0,l.k6)(()=>[e.sessionExpired?((0,l.uX)(),(0,l.Wv)(d,{key:0,color:"warning",class:"mb-4",border:"left","border-color":"warning"},{title:(0,l.k6)(()=>t[4]||(t[4]=[(0,l.eW)("Session Expired")])),default:(0,l.k6)(()=>[t[5]||(t[5]=(0,l.eW)(" Your session has expired. Please log in again to continue. "))]),_:1,__:[5]})):(0,l.Q3)("",!0),(0,l.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)((...t)=>e.handleLogin&&e.handleLogin(...t),["prevent"]))},[(0,l.bF)(u,{modelValue:e.form.email,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.email=t),label:"Email",type:"email",rules:[e.required,e.email],class:"mb-3",error:!!e.loginError},null,8,["modelValue","rules","error"]),(0,l.bF)(u,{modelValue:e.form.password,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.password=t),label:"Password",type:"password",rules:[e.required],class:"mb-4",error:!!e.loginError,"error-messages":e.loginError?[e.loginError]:[]},null,8,["modelValue","rules","error","error-messages"]),(0,l.bF)(c,{type:"submit",color:"primary",block:"",loading:e.isLoggingIn,disabled:!e.isFormValid},{default:(0,l.k6)(()=>t[6]||(t[6]=[(0,l.eW)(" Sign In ")])),_:1,__:[6]},8,["loading","disabled"])],32)]),_:1})]),_:1})])}const Ct=(0,l.pM)({name:"LoginView",emits:["login-success"],props:{sessionExpired:{type:Boolean,default:!1}},data(){return{isLoggingIn:!1,loginError:"",form:{email:"",password:""}}},computed:{isFormValid(){return this.form.email.trim()&&this.form.password.trim()&&this.isValidEmail(this.form.email)}},methods:{required(e){return!!e?.trim()||"This field is required"},email(e){return!!this.isValidEmail(e)||"Please enter a valid email address"},isValidEmail(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)},async handleLogin(){if(this.isFormValid){this.isLoggingIn=!0,this.loginError="";try{await Le(this.form.email.trim(),this.form.password),this.$emit("login-success")}catch(e){console.error("Login failed:",e),"auth/user-not-found"===e.code||"auth/wrong-password"===e.code?this.loginError="Invalid email or password":"auth/invalid-email"===e.code?this.loginError="Invalid email address":"auth/too-many-requests"===e.code?this.loginError="Too many failed attempts. Please try again later":this.loginError="Login failed. Please try again"}finally{this.isLoggingIn=!1}}}}}),Ut=(0,we.A)(Ct,[["render",Dt]]),qt=Ut,Vt={class:"user-avatar-container"},Lt={class:"user-info"},At={class:"user-name"},Ft={class:"user-email"},St={class:"user-details"},Rt={class:"detail-item"},xt={class:"detail-item"},Pt={class:"dropdown-actions"};function Nt(e,t,s,r,a,i){const n=(0,l.g2)("va-avatar"),d=(0,l.g2)("va-button"),u=(0,l.g2)("va-card-content"),c=(0,l.g2)("va-card"),m=(0,l.g2)("va-dropdown");return(0,l.uX)(),(0,l.CE)("div",Vt,[(0,l.bF)(n,{color:e.avatarColor,size:"medium",class:"user-avatar",onClick:e.toggleDropdown},{default:(0,l.k6)(()=>[(0,l.eW)((0,o.v_)(e.initials),1)]),_:1},8,["color","onClick"]),(0,l.bF)(m,{modelValue:e.showDropdown,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showDropdown=t),placement:"bottom-end","close-on-anchor-click":!1},{anchor:(0,l.k6)(()=>t[1]||(t[1]=[(0,l.Lk)("div",null,null,-1)])),default:(0,l.k6)(()=>[(0,l.bF)(c,{class:"user-dropdown"},{default:(0,l.k6)(()=>[(0,l.bF)(u,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",Lt,[(0,l.Lk)("div",At,(0,o.v_)(e.fullName),1),(0,l.Lk)("div",Ft,(0,o.v_)(e.userProfile?.email),1),(0,l.Lk)("div",St,[(0,l.Lk)("div",Rt,[t[2]||(t[2]=(0,l.Lk)("strong",null,"Department:",-1)),(0,l.eW)(" "+(0,o.v_)(e.userProfile?.department),1)]),(0,l.Lk)("div",xt,[t[3]||(t[3]=(0,l.Lk)("strong",null,"Title:",-1)),(0,l.eW)(" "+(0,o.v_)(e.userProfile?.title),1)])])]),(0,l.Lk)("div",Pt,[(0,l.bF)(d,{onClick:e.editProfile,color:"primary",size:"small",icon:"edit",class:"mb-2",block:""},{default:(0,l.k6)(()=>t[4]||(t[4]=[(0,l.eW)(" Edit Profile ")])),_:1,__:[4]},8,["onClick"]),(0,l.bF)(d,{onClick:e.logout,color:"danger",size:"small",icon:"logout",outline:"",block:""},{default:(0,l.k6)(()=>t[5]||(t[5]=[(0,l.eW)(" Logout ")])),_:1,__:[5]},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const It=(0,l.pM)({name:"UserAvatar",emits:["edit-profile","logout"],props:{userProfile:{type:Object,required:!0}},data(){return{showDropdown:!1}},computed:{fullName(){return this.userProfile&&`${this.userProfile.firstName} ${this.userProfile.lastName}`.trim()||"User"},initials(){return this.userProfile&&this.userProfile.firstName&&this.userProfile.lastName?`${this.userProfile.firstName[0]}${this.userProfile.lastName[0]}`.toUpperCase():"U"},avatarColor(){if(!this.userProfile)return"primary";const e=this.fullName,t=["primary","secondary","success","info","warning","danger"],s=e.split("").reduce((e,t)=>e+t.charCodeAt(0),0);return t[s%t.length]}},methods:{toggleDropdown(){this.showDropdown=!this.showDropdown},editProfile(){this.showDropdown=!1,this.$emit("edit-profile")},logout(){this.showDropdown=!1,this.$emit("logout")}}}),Tt=(0,we.A)(It,[["render",Nt]]),Mt=Tt,Wt={class:"profile-form"},Ot={class:"row"},Bt={class:"row"},Xt={class:"form-actions"};function $t(e,t,s,a,o,i){const n=(0,l.g2)("va-input"),d=(0,l.g2)("va-select"),u=(0,l.g2)("va-button"),c=(0,l.g2)("va-modal");return(0,l.uX)(),(0,l.Wv)(c,{modelValue:e.isVisible,"onUpdate:modelValue":t[7]||(t[7]=t=>e.isVisible=t),title:"User Profile",size:"medium","hide-default-actions":!0},{default:(0,l.k6)(()=>[(0,l.Lk)("form",{onSubmit:t[6]||(t[6]=(0,r.D$)((...t)=>e.handleSubmit&&e.handleSubmit(...t),["prevent"]))},[(0,l.Lk)("div",Wt,[(0,l.Lk)("div",Ot,[(0,l.bF)(n,{modelValue:e.form.firstName,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.firstName=t),label:"First Name",rules:[e.required],class:"profile-form-input"},null,8,["modelValue","rules"]),(0,l.bF)(n,{modelValue:e.form.lastName,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.lastName=t),label:"Last Name",rules:[e.required],class:"profile-form-input"},null,8,["modelValue","rules"])]),(0,l.Lk)("div",Bt,[(0,l.bF)(d,{modelValue:e.form.department,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.department=t),label:"Department",options:e.departments,rules:[e.required],class:"profile-form-input"},null,8,["modelValue","options","rules"]),(0,l.bF)(n,{modelValue:e.form.title,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.title=t),label:"Job Title",rules:[e.required],class:"profile-form-input"},null,8,["modelValue","rules"])]),(0,l.bF)(n,{modelValue:e.form.email,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.email=t),label:"Email",disabled:"",class:"mb-3"},null,8,["modelValue"]),(0,l.Lk)("div",Xt,[(0,l.bF)(u,{type:"button",onClick:t[5]||(t[5]=t=>e.$emit("close")),color:"secondary",class:"mr-3"},{default:(0,l.k6)(()=>t[8]||(t[8]=[(0,l.eW)(" Cancel ")])),_:1,__:[8]}),(0,l.bF)(u,{type:"submit",color:"primary",loading:e.isSaving,disabled:!e.isFormValid},{default:(0,l.k6)(()=>t[9]||(t[9]=[(0,l.eW)(" Save ")])),_:1,__:[9]},8,["loading","disabled"])])])],32)]),_:1},8,["modelValue"])}const zt=(0,l.pM)({name:"UserProfileModal",emits:["close","saved"],props:{isVisible:{type:Boolean,required:!0},userProfile:{type:Object,default:null}},data(){return{isSaving:!1,departments:ut,form:{firstName:"",lastName:"",department:"",title:"",email:""}}},computed:{isFormValid(){return this.form.firstName.trim()&&this.form.lastName.trim()&&this.form.department&&this.form.title.trim()}},watch:{userProfile:{handler(e){this.form=e?{firstName:e.firstName||"",lastName:e.lastName||"",department:e.department||"",title:e.title||"",email:e.email||""}:{firstName:"",lastName:"",department:"",title:"",email:""}},immediate:!0}},methods:{required(e){return!!e?.trim()||"This field is required"},async handleSubmit(){if(this.isFormValid){this.isSaving=!0;try{this.$emit("saved",{firstName:this.form.firstName.trim(),lastName:this.form.lastName.trim(),department:this.form.department,title:this.form.title.trim()})}catch(e){console.error("Error in form submission:",e)}finally{this.isSaving=!1}}}}}),Ht=(0,we.A)(zt,[["render",$t]]),jt=Ht,Kt={class:"user-management"},Qt={class:"d-flex justify-between align-center mb-4"},Gt={class:"row"},Jt={class:"flex md6"},Yt={class:"flex md6"},Zt={class:"row"},es={class:"flex md6"},ts={class:"flex md6"},ss={class:"row"},rs={class:"flex md6"},ls={class:"flex md6"},as={class:"d-flex justify-end"},os={class:"d-flex gap-2"},is={class:"pa-4"},ns={class:"d-flex justify-end mt-4"};function ds(e,t,s,a,i,n){const d=(0,l.g2)("va-button"),u=(0,l.g2)("va-card-title"),c=(0,l.g2)("va-input"),m=(0,l.g2)("va-select"),h=(0,l.g2)("va-card-content"),p=(0,l.g2)("va-card"),f=(0,l.g2)("va-badge"),g=(0,l.g2)("va-data-table"),w=(0,l.g2)("va-modal");return(0,l.uX)(),(0,l.Wv)(w,{modelValue:e.isVisible,"onUpdate:modelValue":t[11]||(t[11]=t=>e.isVisible=t),title:"User Management",size:"large","hide-default-actions":!0,onOk:e.close,onCancel:e.close},{default:(0,l.k6)(()=>[(0,l.Lk)("div",Kt,[(0,l.Lk)("div",Qt,[t[13]||(t[13]=(0,l.Lk)("h4",null,"System Users",-1)),(0,l.bF)(d,{onClick:t[0]||(t[0]=t=>e.showAddUserForm=!0),color:"primary",icon:"add"},{default:(0,l.k6)(()=>t[12]||(t[12]=[(0,l.eW)(" Add User ")])),_:1,__:[12]})]),e.showAddUserForm?((0,l.uX)(),(0,l.Wv)(p,{key:0,class:"mb-4"},{default:(0,l.k6)(()=>[(0,l.bF)(u,null,{default:(0,l.k6)(()=>t[14]||(t[14]=[(0,l.eW)("Add New User")])),_:1,__:[14]}),(0,l.bF)(h,null,{default:(0,l.k6)(()=>[(0,l.Lk)("form",{onSubmit:t[8]||(t[8]=(0,r.D$)((...t)=>e.handleAddUser&&e.handleAddUser(...t),["prevent"]))},[(0,l.Lk)("div",Gt,[(0,l.Lk)("div",Jt,[(0,l.bF)(c,{modelValue:e.newUser.email,"onUpdate:modelValue":t[1]||(t[1]=t=>e.newUser.email=t),label:"Email",type:"email",rules:[e.required,e.email],class:"mb-3"},null,8,["modelValue","rules"])]),(0,l.Lk)("div",Yt,[(0,l.bF)(c,{modelValue:e.newUser.firstName,"onUpdate:modelValue":t[2]||(t[2]=t=>e.newUser.firstName=t),label:"First Name",rules:[e.required],class:"mb-3"},null,8,["modelValue","rules"])])]),(0,l.Lk)("div",Zt,[(0,l.Lk)("div",es,[(0,l.bF)(c,{modelValue:e.newUser.lastName,"onUpdate:modelValue":t[3]||(t[3]=t=>e.newUser.lastName=t),label:"Last Name",rules:[e.required],class:"mb-3"},null,8,["modelValue","rules"])]),(0,l.Lk)("div",ts,[(0,l.bF)(m,{modelValue:e.newUser.department,"onUpdate:modelValue":t[4]||(t[4]=t=>e.newUser.department=t),label:"Department",options:e.departments,rules:[e.required],class:"mb-3"},null,8,["modelValue","options","rules"])])]),(0,l.Lk)("div",ss,[(0,l.Lk)("div",rs,[(0,l.bF)(c,{modelValue:e.newUser.title,"onUpdate:modelValue":t[5]||(t[5]=t=>e.newUser.title=t),label:"Job Title",rules:[e.required],class:"mb-3"},null,8,["modelValue","rules"])]),(0,l.Lk)("div",ls,[(0,l.bF)(m,{modelValue:e.newUser.role,"onUpdate:modelValue":t[6]||(t[6]=t=>e.newUser.role=t),options:e.roleOptions,label:"Role",rules:[e.requiredSelect],class:"mb-3"},null,8,["modelValue","options","rules"])])]),(0,l.Lk)("div",as,[(0,l.bF)(d,{onClick:t[7]||(t[7]=t=>e.showAddUserForm=!1),color:"secondary",class:"mr-2"},{default:(0,l.k6)(()=>t[15]||(t[15]=[(0,l.eW)(" Cancel ")])),_:1,__:[15]}),(0,l.bF)(d,{type:"submit",color:"primary",loading:e.addingUser,disabled:!e.isNewUserFormValid},{default:(0,l.k6)(()=>t[16]||(t[16]=[(0,l.eW)(" Add User ")])),_:1,__:[16]},8,["loading","disabled"])])],32)]),_:1})]),_:1})):(0,l.Q3)("",!0),(0,l.bF)(g,{items:e.users,columns:e.columns,loading:e.loading,striped:""},{"cell(name)":(0,l.k6)(({rowData:e})=>[(0,l.eW)((0,o.v_)(e.firstName)+" "+(0,o.v_)(e.lastName),1)]),"cell(role)":(0,l.k6)(({rowData:t})=>[(0,l.bF)(f,{color:e.getRoleColor(t.role),text:e.getRoleLabel(t.role)},null,8,["color","text"])]),"cell(actions)":(0,l.k6)(({rowData:t})=>[(0,l.Lk)("div",os,[(0,l.bF)(m,{modelValue:t.role,"onUpdate:modelValue":[e=>t.role=e,s=>e.updateUserRole(t.uid,s)],options:e.roleOptions,size:"small",class:"role-select"},null,8,["modelValue","onUpdate:modelValue","options"]),(0,l.bF)(d,{onClick:s=>e.confirmDeleteUser(t.uid),color:"danger",icon:"delete",size:"small",preset:"plain",disabled:t.uid===e.currentUserId},null,8,["onClick","disabled"])])]),_:1},8,["items","columns","loading"]),(0,l.bF)(w,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":t[10]||(t[10]=t=>e.showDeleteDialog=t),title:"Confirm Delete",size:"small","hide-default-actions":!0},{default:(0,l.k6)(()=>[(0,l.Lk)("div",is,[t[19]||(t[19]=(0,l.Lk)("p",null," Are you sure you want to delete this user? This action cannot be undone. ",-1)),(0,l.Lk)("div",ns,[(0,l.bF)(d,{onClick:t[9]||(t[9]=t=>e.showDeleteDialog=!1),color:"secondary",class:"mr-2"},{default:(0,l.k6)(()=>t[17]||(t[17]=[(0,l.eW)(" Cancel ")])),_:1,__:[17]}),(0,l.bF)(d,{onClick:e.deleteUser,color:"danger",loading:e.deletingUser},{default:(0,l.k6)(()=>t[18]||(t[18]=[(0,l.eW)(" Delete ")])),_:1,__:[18]},8,["onClick","loading"])])])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue","onOk","onCancel"])}const us=(0,l.pM)({name:"UserManagementModal",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],data(){return{users:[],loading:!1,showAddUserForm:!1,addingUser:!1,showDeleteDialog:!1,deletingUser:!1,userToDelete:null,newUser:{email:"",firstName:"",lastName:"",department:"",title:"",role:"user"},roleOptions:[{value:"viewer",text:"Viewer"},{value:"user",text:"User"},{value:"admin",text:"Admin"}],departments:ut,columns:[{key:"name",label:"Name"},{key:"email",label:"Email"},{key:"department",label:"Department"},{key:"title",label:"Job Title"},{key:"role",label:"Role"},{key:"actions",label:"Actions"}]}},computed:{isVisible:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},currentUserId(){return Se()?.uid},isNewUserFormValid(){return this.newUser.email&&this.newUser.firstName&&this.newUser.lastName&&this.newUser.department&&this.newUser.title&&this.newUser.role}},watch:{modelValue(e){e&&this.loadUsers()}},methods:{async loadUsers(){this.loading=!0;try{this.users=await Te()}catch(e){console.error("Error loading users:",e),this.$vaToast.init({message:"Error loading users",color:"danger"})}finally{this.loading=!1}},async handleAddUser(){if(this.isNewUserFormValid){this.addingUser=!0;try{await Me(this.newUser.email,"123456",{firstName:this.newUser.firstName,lastName:this.newUser.lastName,department:this.newUser.department,title:this.newUser.title,role:this.newUser.role}),this.$vaToast.init({message:"User created successfully",color:"success"}),this.resetNewUserForm(),this.showAddUserForm=!1,await this.loadUsers()}catch(e){console.error("Error creating user:",e),this.$vaToast.init({message:"Error creating user",color:"danger"})}finally{this.addingUser=!1}}},async updateUserRole(e,t){try{await We(e,t),this.$vaToast.init({message:"User role updated successfully",color:"success"})}catch(s){console.error("Error updating user role:",s),this.$vaToast.init({message:"Error updating user role",color:"danger"}),await this.loadUsers()}},confirmDeleteUser(e){this.userToDelete=e,this.showDeleteDialog=!0},async deleteUser(){if(this.userToDelete){this.deletingUser=!0;try{await Oe(this.userToDelete),this.$vaToast.init({message:"User deleted successfully",color:"success"}),await this.loadUsers()}catch(e){console.error("Error deleting user:",e),this.$vaToast.init({message:"Error deleting user",color:"danger"})}finally{this.deletingUser=!1,this.showDeleteDialog=!1,this.userToDelete=null}}},resetNewUserForm(){this.newUser={email:"",firstName:"",lastName:"",department:"",title:"",role:"user"}},getRoleColor(e){switch(e){case"admin":return"danger";case"user":return"primary";case"viewer":return"secondary";default:return"secondary"}},getRoleLabel(e){switch(e){case"admin":return"Admin";case"user":return"User";case"viewer":return"Viewer";default:return"Unknown"}},close(){this.isVisible=!1},required(e){return!!e||"This field is required"},requiredSelect(e){return!!e||"This field is required"},email(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)||"Please enter a valid email address"}}}),cs=(0,we.A)(us,[["render",ds]]),ms=cs;var hs=s(959);const ps=(0,l.pM)({name:"HomePage",components:{RequestList:lt,RequestForm:_t,AddComment:be,LoginView:qt,UserAvatar:Mt,UserProfileModal:jt,UserManagementModal:ms},data(){return{currentView:"home",requests:[],selectedRequest:null,selectedRequestComments:[],showModal:!1,showDeleteRequestDialog:!1,showDeleteCommentDialog:!1,deletingRequest:!1,deletingComment:!1,filters:{status:"All",senderDepartment:"All Sender Departments",receiverDepartment:"All Receiver Departments",search:"",dateFrom:null,dateTo:null},showAdvancedFilters:!1,commentIdToDelete:null,showProfileModal:!1,showUserManagementModal:!1,showExportModal:!1,exportLoading:!1,includeComments:!1,applyCurrentFilters:!0,exportFields:[{key:"id",label:"ID",selected:!0},{key:"title",label:"Title",selected:!0},{key:"details",label:"Details",selected:!0},{key:"status",label:"Status",selected:!0},{key:"senderName",label:"Sender Name",selected:!0},{key:"senderDepartment",label:"Sender Department",selected:!0},{key:"receiverDepartment",label:"Receiver Department",selected:!0},{key:"createdAt",label:"Created Date",selected:!0},{key:"updatedAt",label:"Updated Date",selected:!1}]}},computed:{departmentOptions(){return ct},senderDepartmentOptions(){return mt},receiverDepartmentOptions(){return ht},isAuthenticated(){return bt.isAuthenticated},currentUserProfile(){return bt.user},authLoading(){return bt.loading},authError(){return bt.error},sessionExpired(){return bt.sessionExpired},canCreateRequests(){return bt.canCreateRequests},canComment(){return bt.canComment},canDelete(){return bt.canDelete},canDeleteAll(){return bt.canDeleteAll},canManageUsers(){return bt.canManageUsers},isViewOnly(){return bt.isViewOnly},filteredRequests(){return this.requests.filter(e=>{const t="All"===this.filters.status||e.status===this.filters.status,s="All Sender Departments"===this.filters.senderDepartment||e.senderDepartment===this.filters.senderDepartment,r="All Receiver Departments"===this.filters.receiverDepartment||e.receiverDepartment===this.filters.receiverDepartment,l=!this.filters.search||e.title.toLowerCase().includes(this.filters.search.toLowerCase())||e.details.toLowerCase().includes(this.filters.search.toLowerCase())||e.senderName.toLowerCase().includes(this.filters.search.toLowerCase())||e.senderDepartment.toLowerCase().includes(this.filters.search.toLowerCase())||e.receiverDepartment.toLowerCase().includes(this.filters.search.toLowerCase()),a=!this.filters.dateFrom||e.createdAt>=this.filters.dateFrom.getTime(),o=!this.filters.dateTo||e.createdAt<=this.filters.dateTo.getTime();return t&&s&&r&&l&&a&&o})},availableActions(){return{viewRequests:{title:"View All Requests",description:"Browse and manage action requests",icon:"list",color:"primary",buttonText:"View Requests",enabled:!0,view:"requests"},addRequest:{title:"Add New Request",description:"Create a new action request",icon:"add_circle",color:"success",buttonText:"Add Request",enabled:this.canCreateRequests,view:"add-request"},userManagement:{title:"User Management",description:"Manage users and permissions",icon:"people",color:"info",buttonText:"Manage Users",enabled:this.canManageUsers,view:"user-management"}}},hasSelectedFields(){return this.exportFields.some(e=>e.selected)},requestsToExport(){return this.applyCurrentFilters?this.filteredRequests:this.requests}},async created(){bt.isAuthenticated&&await this.loadRequests()},watch:{isAuthenticated:{handler(e){e?this.loadRequests():this.requests=[]},immediate:!0}},methods:{async handleLoginSuccess(){!this.currentUserProfile||this.currentUserProfile.firstName&&this.currentUserProfile.lastName&&this.currentUserProfile.department&&this.currentUserProfile.title||(this.showProfileModal=!0)},openProfileModal(){this.showProfileModal=!0},async handleLogout(){try{await bt.logout()}catch(e){console.error("Error signing out:",e)}},async handleProfileSave(e){try{await bt.saveUserProfile(e),this.showProfileModal=!1}catch(t){console.error("Error saving profile:",t)}},async loadRequests(){try{this.requests=await He()}catch(e){console.error("Error loading requests:",e)}},async handleNewRequest(e){try{await je({...e,createdAt:Date.now()}),await this.loadRequests(),this.currentView="home"}catch(t){console.error("Error adding request:",t)}},async handleComment(e){try{await Je(e.id,e.text),await this.loadRequests()}catch(t){console.error("Error adding comment:",t)}},async showRequestDetails(e){if(this.selectedRequest=e,this.showModal=!0,e.id)try{this.selectedRequestComments=await Ke(e.id)}catch(t){console.error("Error loading comments:",t),this.selectedRequestComments=[]}},async handleModalComment(e){if(this.selectedRequest?.id)try{await Je(this.selectedRequest.id,e),this.selectedRequestComments=await Ke(this.selectedRequest.id),await this.loadRequests()}catch(t){console.error("Error adding comment:",t)}},confirmDeleteRequestFromList(e){this.selectedRequest=e,this.confirmDeleteRequest()},confirmDeleteRequest(){this.showDeleteRequestDialog=!0},async deleteRequest(){if(this.selectedRequest?.id){this.deletingRequest=!0;try{await Ge(this.selectedRequest.id),await this.reloadRequests(),this.showModal=!1}catch(e){console.error("Error deleting request:",e)}finally{this.deletingRequest=!1,this.showDeleteRequestDialog=!1}}},confirmDeleteComment(e){e&&(this.commentIdToDelete=e,this.showDeleteCommentDialog=!0)},async deleteComment(){if(this.commentIdToDelete&&this.selectedRequest?.id){this.deletingComment=!0;try{await Ye(this.selectedRequest.id,this.commentIdToDelete),this.selectedRequestComments=this.selectedRequestComments.filter(e=>e.id!==this.commentIdToDelete)}catch(e){console.error("Error deleting comment:",e)}finally{this.deletingComment=!1,this.showDeleteCommentDialog=!1,this.commentIdToDelete=null}}},getStatusColor(e){switch(e){case"Open":return"warning";case"In-Progress":return"primary";case"Closed":return"success";default:return"secondary"}},formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},selectAction(e){const t=this.availableActions,s=t[e];s&&s.enabled&&("user-management"===s.view?this.showUserManagementModal=!0:this.currentView=s.view)},openExportModal(){this.showExportModal=!0},async exportToExcel(){if(this.hasSelectedFields){this.exportLoading=!0;try{const e=this.requestsToExport;if(0===e.length)return void this.$vaToast.init({message:"No data to export",color:"warning"});const t=this.exportFields.filter(e=>e.selected),s=[],r=t.map(e=>e.label);this.includeComments&&r.push("Comments"),s.push(r);for(const i of e){const e=t.map(e=>{let t=i[e.key];return"createdAt"!==e.key&&"updatedAt"!==e.key||t&&"number"===typeof t&&(t=new Date(t).toLocaleString()),t||""});if(this.includeComments){const t=i.comments||[],s=t.map(e=>`${e.authorName} (${new Date(e.createdAt).toLocaleString()}): ${e.text}`).join("; ");e.push(s)}s.push(e)}const l=hs.Wp.book_new(),a=hs.Wp.aoa_to_sheet(s);hs.Wp.book_append_sheet(l,a,"Action Requests");const o=`action-requests-${(new Date).toISOString().split("T")[0]}.xlsx`;hs._h(l,o),this.$vaToast.init({message:"Excel file exported successfully",color:"success"}),this.showExportModal=!1}catch(e){console.error("Error exporting Excel:",e),this.$vaToast.init({message:"Error exporting Excel file",color:"danger"})}finally{this.exportLoading=!1}}},goHome(){this.currentView="home"},async reloadRequests(){try{this.requests=await He()}catch(e){console.error("Error reloading requests:",e)}}}}),fs=(0,we.A)(ps,[["render",$]]),gs=fs,ws=(0,l.pM)({name:"App",components:{HomePage:gs}}),vs=(0,we.A)(ws,[["render",a]]),bs=vs;var ks=s(857);s(951);const ys=(0,r.Ef)(bs);ys.use((0,ks.c)()),bt.initialize(),ys.mount("#app")}},t={};function s(r){var l=t[r];if(void 0!==l)return l.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,s),a.exports}s.m=e,(()=>{var e=[];s.O=(t,r,l,a)=>{if(!r){var o=1/0;for(u=0;u<e.length;u++){for(var[r,l,a]=e[u],i=!0,n=0;n<r.length;n++)(!1&a||o>=a)&&Object.keys(s.O).every(e=>s.O[e](r[n]))?r.splice(n--,1):(i=!1,a<o&&(o=a));if(i){e.splice(u--,1);var d=l();void 0!==d&&(t=d)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,l,a]}})(),(()=>{s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={524:0};s.O.j=t=>0===e[t];var t=(t,r)=>{var l,a,[o,i,n]=r,d=0;if(o.some(t=>0!==e[t])){for(l in i)s.o(i,l)&&(s.m[l]=i[l]);if(n)var u=n(s)}for(t&&t(r);d<o.length;d++)a=o[d],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(u)},r=self["webpackChunkaction_tracker"]=self["webpackChunkaction_tracker"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=s.O(void 0,[504],()=>s(167));r=s.O(r)})();